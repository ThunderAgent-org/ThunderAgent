{
    "django__django-13925": {
        "model_name_or_path": "vllm_local__--data--models--GLM-4.5-FP8__t-0.00__p-1.00__c-0.00___swe_bench_lite_test__bs1",
        "instance_id": "django__django-13925",
        "model_patch": "diff --git a/django/db/models/base.py b/django/db/models/base.py\nindex 4038859cfa..fac3710023 100644\n--- a/django/db/models/base.py\n+++ b/django/db/models/base.py\n@@ -1302,6 +1302,23 @@ class Model(metaclass=ModelBase):\n             not settings.is_overridden('DEFAULT_AUTO_FIELD') and\n             not cls._meta.app_config._is_default_auto_field_overridden\n         ):\n+            # Check if any parent or ancestor has an explicit (non-auto_created) primary key\n+            def check_ancestors(model):\n+                # Check if this model has an explicit primary key\n+                if not model._meta.pk.auto_created:\n+                    return True\n+                # Recursively check all parents\n+                for parent in model._meta.parents.keys():\n+                    if check_ancestors(parent):\n+                        return True\n+                return False\n+            \n+            for parent in cls._meta.parents.keys():\n+                if check_ancestors(parent):\n+                    # Parent or ancestor has an explicit primary key, so no warning needed\n+                    return []\n+            \n+            # No parent has an explicit primary key, generate the warning\n             return [\n                 checks.Warning(\n                     f\"Auto-created primary key used when not defining a \"\n"
    },
    "django__django-13933": {
        "model_name_or_path": "vllm_local__--data--models--GLM-4.5-FP8__t-0.00__p-1.00__c-0.00___swe_bench_lite_test__bs1",
        "instance_id": "django__django-13933",
        "model_patch": "diff --git a/django/forms/models.py b/django/forms/models.py\nindex 422bc5d178..e03a3803cd 100644\n--- a/django/forms/models.py\n+++ b/django/forms/models.py\n@@ -1188,7 +1188,7 @@ class ModelChoiceField(ChoiceField):\n     # This class is a subclass of ChoiceField for purity, but it doesn't\n     # actually use any of ChoiceField's implementation.\n     default_error_messages = {\n-        'invalid_choice': _('Select a valid choice. That choice is not one of'\n+        'invalid_choice': _('Select a valid choice. %(value)s is not one of'\n                             ' the available choices.'),\n     }\n     iterator = ModelChoiceIterator\n@@ -1284,7 +1284,11 @@ class ModelChoiceField(ChoiceField):\n                 value = getattr(value, key)\n             value = self.queryset.get(**{key: value})\n         except (ValueError, TypeError, self.queryset.model.DoesNotExist):\n-            raise ValidationError(self.error_messages['invalid_choice'], code='invalid_choice')\n+            raise ValidationError(\n+                self.error_messages['invalid_choice'],\n+                code='invalid_choice',\n+                params={'value': value},\n+            )\n         return value\n \n     def validate(self, value):\ndiff --git a/tests/model_forms/test_modelchoicefield.py b/tests/model_forms/test_modelchoicefield.py\nindex 8f41ce9c40..fe0968f893 100644\n--- a/tests/model_forms/test_modelchoicefield.py\n+++ b/tests/model_forms/test_modelchoicefield.py\n@@ -51,7 +51,7 @@ class ModelChoiceFieldTests(TestCase):\n         # instantiated. This proves clean() checks the database during clean()\n         # rather than caching it at instantiation time.\n         Category.objects.get(url='4th').delete()\n-        msg = \"['Select a valid choice. That choice is not one of the available choices.']\"\n+        msg = f\"['Select a valid choice. {c4.id} is not one of the available choices.']\"\n         with self.assertRaisesMessage(ValidationError, msg):\n             f.clean(c4.id)\n \n@@ -59,9 +59,10 @@ class ModelChoiceFieldTests(TestCase):\n         f = forms.ModelChoiceField(Category.objects.all())\n         self.assertEqual(f.clean(self.c1), self.c1)\n         # An instance of incorrect model.\n-        msg = \"['Select a valid choice. That choice is not one of the available choices.']\"\n+        book = Book.objects.create()\n+        msg = f\"['Select a valid choice. {book} is not one of the available choices.']\"\n         with self.assertRaisesMessage(ValidationError, msg):\n-            f.clean(Book.objects.create())\n+            f.clean(book)\n \n     def test_clean_to_field_name(self):\n         f = forms.ModelChoiceField(Category.objects.all(), to_field_name='slug')\n"
    },
    "django__django-13964": {
        "model_name_or_path": "vllm_local__--data--models--GLM-4.5-FP8__t-0.00__p-1.00__c-0.00___swe_bench_lite_test__bs1",
        "instance_id": "django__django-13964",
        "model_patch": "diff --git a/django/db/models/fields/related_descriptors.py b/django/db/models/fields/related_descriptors.py\nindex 872a4c98dc..552ddf4732 100644\n--- a/django/db/models/fields/related_descriptors.py\n+++ b/django/db/models/fields/related_descriptors.py\n@@ -70,6 +70,7 @@ from django.db.models.query import QuerySet\n from django.db.models.query_utils import DeferredAttribute\n from django.db.models.utils import resolve_callables\n from django.utils.functional import cached_property\n+from . import AutoField, BigAutoField, SmallAutoField\n \n \n class ForeignKeyDeferredAttribute(DeferredAttribute):\n@@ -254,7 +255,18 @@ class ForwardManyToOneDescriptor:\n         # Set the values of the related field.\n         else:\n             for lh_field, rh_field in self.field.related_fields:\n-                setattr(instance, lh_field.attname, getattr(value, rh_field.attname))\n+                # Check if the related object is unsaved and has a non-auto primary key\n+                # that is currently empty. If so, skip setting the foreign key value\n+                # immediately to avoid setting it to an empty value.\n+                related_obj_pk_value = getattr(value, rh_field.attname)\n+                should_skip = (\n+                    value._state.adding and  # Related object is unsaved\n+                    not isinstance(rh_field, (AutoField, BigAutoField, SmallAutoField)) and  # Non-auto PK\n+                    (related_obj_pk_value is None or related_obj_pk_value == '')  # PK is empty\n+                )\n+                \n+                if not should_skip:\n+                    setattr(instance, lh_field.attname, related_obj_pk_value)\n \n         # Set the related instance cache used by __get__ to avoid an SQL query\n         # when accessing the attribute we just set.\n"
    },
    "django__django-14016": {
        "model_name_or_path": "vllm_local__--data--models--GLM-4.5-FP8__t-0.00__p-1.00__c-0.00___swe_bench_lite_test__bs1",
        "instance_id": "django__django-14016",
        "model_patch": "diff --git a/django/db/models/query_utils.py b/django/db/models/query_utils.py\nindex c2623f099f..bbcbdbd478 100644\n--- a/django/db/models/query_utils.py\n+++ b/django/db/models/query_utils.py\n@@ -46,10 +46,16 @@ class Q(tree.Node):\n \n         # If the other Q() is empty, ignore it and just use `self`.\n         if not other:\n-            return copy.deepcopy(self)\n+            # Create a new Q object with the same properties as self, but without deepcopying\n+            obj = type(self)(_connector=self.connector, _negated=self.negated)\n+            obj.children = self.children[:]  # Shallow copy of children\n+            return obj\n         # Or if this Q is empty, ignore it and just use `other`.\n         elif not self:\n-            return copy.deepcopy(other)\n+            # Create a new Q object with the same properties as other, but without deepcopying\n+            obj = type(self)(_connector=other.connector, _negated=other.negated)\n+            obj.children = other.children[:]  # Shallow copy of children\n+            return obj\n \n         obj = type(self)()\n         obj.connector = conn\n"
    },
    "django__django-14017": {
        "model_name_or_path": "vllm_local__--data--models--GLM-4.5-FP8__t-0.00__p-1.00__c-0.00___swe_bench_lite_test__bs1",
        "instance_id": "django__django-14017",
        "model_patch": "diff --git a/django/db/models/expressions.py b/django/db/models/expressions.py\nindex ffc3a7fda5..8b4ccceaf4 100644\n--- a/django/db/models/expressions.py\n+++ b/django/db/models/expressions.py\n@@ -137,11 +137,15 @@ class Combinable:\n         return self._combine(other, self.POW, True)\n \n     def __rand__(self, other):\n+        if getattr(self, 'conditional', False) and getattr(other, 'conditional', False):\n+            return Q(other) & Q(self)\n         raise NotImplementedError(\n             \"Use .bitand() and .bitor() for bitwise logical operations.\"\n         )\n \n     def __ror__(self, other):\n+        if getattr(self, 'conditional', False) and getattr(other, 'conditional', False):\n+            return Q(other) | Q(self)\n         raise NotImplementedError(\n             \"Use .bitand() and .bitor() for bitwise logical operations.\"\n         )\ndiff --git a/django/db/models/query_utils.py b/django/db/models/query_utils.py\nindex c957ffa564..4d8aaa0044 100644\n--- a/django/db/models/query_utils.py\n+++ b/django/db/models/query_utils.py\n@@ -41,6 +41,8 @@ class Q(tree.Node):\n \n     def _combine(self, other, conn):\n         if not isinstance(other, Q):\n+            if getattr(other, 'conditional', False):\n+                return NotImplemented\n             raise TypeError(other)\n \n         # If the other Q() is empty, ignore it and just use `self`.\n@@ -58,11 +60,21 @@ class Q(tree.Node):\n         obj.add(other, conn)\n         return obj\n \n+    def __and__(self, other):\n+        return self._combine(other, self.AND)\n+\n+    def __rand__(self, other):\n+        if getattr(other, 'conditional', False):\n+            return Q(other) & self\n+        raise TypeError(other)\n+\n     def __or__(self, other):\n         return self._combine(other, self.OR)\n \n-    def __and__(self, other):\n-        return self._combine(other, self.AND)\n+    def __ror__(self, other):\n+        if getattr(other, 'conditional', False):\n+            return Q(other) | self\n+        raise TypeError(other)\n \n     def __invert__(self):\n         obj = type(self)()\n"
    }
}