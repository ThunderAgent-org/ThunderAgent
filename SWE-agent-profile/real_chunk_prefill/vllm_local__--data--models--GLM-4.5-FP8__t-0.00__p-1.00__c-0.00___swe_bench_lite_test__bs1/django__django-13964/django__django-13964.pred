{"model_name_or_path": "vllm_local__--data--models--GLM-4.5-FP8__t-0.00__p-1.00__c-0.00___swe_bench_lite_test__bs1", "instance_id": "django__django-13964", "model_patch": "diff --git a/django/db/models/fields/related_descriptors.py b/django/db/models/fields/related_descriptors.py\nindex 872a4c98dc..552ddf4732 100644\n--- a/django/db/models/fields/related_descriptors.py\n+++ b/django/db/models/fields/related_descriptors.py\n@@ -70,6 +70,7 @@ from django.db.models.query import QuerySet\n from django.db.models.query_utils import DeferredAttribute\n from django.db.models.utils import resolve_callables\n from django.utils.functional import cached_property\n+from . import AutoField, BigAutoField, SmallAutoField\n \n \n class ForeignKeyDeferredAttribute(DeferredAttribute):\n@@ -254,7 +255,18 @@ class ForwardManyToOneDescriptor:\n         # Set the values of the related field.\n         else:\n             for lh_field, rh_field in self.field.related_fields:\n-                setattr(instance, lh_field.attname, getattr(value, rh_field.attname))\n+                # Check if the related object is unsaved and has a non-auto primary key\n+                # that is currently empty. If so, skip setting the foreign key value\n+                # immediately to avoid setting it to an empty value.\n+                related_obj_pk_value = getattr(value, rh_field.attname)\n+                should_skip = (\n+                    value._state.adding and  # Related object is unsaved\n+                    not isinstance(rh_field, (AutoField, BigAutoField, SmallAutoField)) and  # Non-auto PK\n+                    (related_obj_pk_value is None or related_obj_pk_value == '')  # PK is empty\n+                )\n+                \n+                if not should_skip:\n+                    setattr(instance, lh_field.attname, related_obj_pk_value)\n \n         # Set the related instance cache used by __get__ to avoid an SQL query\n         # when accessing the attribute we just set.\n"}