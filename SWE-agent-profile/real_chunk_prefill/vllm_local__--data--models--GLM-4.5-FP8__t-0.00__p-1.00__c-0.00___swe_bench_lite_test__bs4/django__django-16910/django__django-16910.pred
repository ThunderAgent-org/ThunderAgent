{"model_name_or_path": "vllm_local__--data--models--GLM-4.5-FP8__t-0.00__p-1.00__c-0.00___swe_bench_lite_test__bs4", "instance_id": "django__django-16910", "model_patch": "diff --git a/django/db/models/query_utils.py b/django/db/models/query_utils.py\nindex 78148f76b0..de240496f4 100644\n--- a/django/db/models/query_utils.py\n+++ b/django/db/models/query_utils.py\n@@ -329,17 +329,21 @@ def select_related_descend(field, restricted, requested, select_mask, reverse=Fa\n     \"\"\"\n     if not field.remote_field:\n         return False\n-    if field.remote_field.parent_link and not reverse:\n+    if not reverse and hasattr(field.remote_field, 'parent_link') and field.remote_field.parent_link:\n         return False\n     if restricted:\n-        if reverse and field.related_query_name() not in requested:\n-            return False\n+        if reverse:\n+            # For reverse relations, use related_query_name instead of field.name\n+            related_query_name = field.related_query_name() if callable(field.related_query_name) else field.related_query_name\n+            if related_query_name not in requested:\n+                return False\n         if not reverse and field.name not in requested:\n             return False\n     if not restricted and field.null:\n         return False\n     if (\n-        restricted\n+        not reverse  # Skip this check for reverse relations\n+        and restricted\n         and select_mask\n         and field.name in requested\n         and field not in select_mask\ndiff --git a/django/db/models/sql/compiler.py b/django/db/models/sql/compiler.py\nindex b28dc925ba..2eb2c67b74 100644\n--- a/django/db/models/sql/compiler.py\n+++ b/django/db/models/sql/compiler.py\n@@ -1250,7 +1250,18 @@ class SQLCompiler:\n                 if o.field.unique and not o.many_to_many\n             ]\n             for related_field, model in related_fields:\n-                related_select_mask = select_mask.get(related_field) or {}\n+                # Find the OneToOneRel object that corresponds to this OneToOneField\n+                # The select_mask is keyed by the reverse relation object, not the forward field\n+                reverse_relation = None\n+                for rel_obj in opts.related_objects:\n+                    if rel_obj.field == related_field:\n+                        reverse_relation = rel_obj\n+                        break\n+                \n+                if reverse_relation:\n+                    related_select_mask = select_mask.get(reverse_relation) or {}\n+                else:\n+                    related_select_mask = {}\n                 if not select_related_descend(\n                     related_field,\n                     restricted,\n"}