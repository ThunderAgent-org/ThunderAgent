{"model_name_or_path": "vllm_local__--data--models--GLM-4.5-FP8__t-0.00__p-1.00__c-0.00___swe_bench_lite_test__bs4", "instance_id": "django__django-16400", "model_patch": "diff --git a/django/contrib/auth/management/__init__.py b/django/contrib/auth/management/__init__.py\nindex 0b5a982617..718fb89144 100644\n--- a/django/contrib/auth/management/__init__.py\n+++ b/django/contrib/auth/management/__init__.py\n@@ -95,11 +95,13 @@ def create_permissions(\n         .values_list(\"content_type\", \"codename\")\n     )\n \n-    perms = [\n-        Permission(codename=codename, name=name, content_type=ct)\n-        for ct, (codename, name) in searched_perms\n-        if (ct.pk, codename) not in all_perms\n-    ]\n+    perms = []\n+    for ct, (codename, name) in searched_perms:\n+        if (ct.pk, codename) not in all_perms:\n+            perm = Permission(codename=codename, name=name)\n+            perm._state.db = using\n+            perm.content_type = ct\n+            perms.append(perm)\n     Permission.objects.using(using).bulk_create(perms)\n     if verbosity >= 2:\n         for perm in perms:\ndiff --git a/django/contrib/contenttypes/management/__init__.py b/django/contrib/contenttypes/management/__init__.py\nindex 903b9ab1a0..15ce060fb6 100644\n--- a/django/contrib/contenttypes/management/__init__.py\n+++ b/django/contrib/contenttypes/management/__init__.py\n@@ -93,7 +93,7 @@ def get_contenttypes_and_models(app_config, using, ContentType):\n     if not router.allow_migrate_model(using, ContentType):\n         return None, None\n \n-    ContentType.objects.clear_cache()\n+    ContentType.objects.clear_cache(using)\n \n     content_types = {\n         ct.model: ct\n@@ -139,7 +139,17 @@ def create_contenttypes(\n         for (model_name, model) in app_models.items()\n         if model_name not in content_types\n     ]\n-    ContentType.objects.using(using).bulk_create(cts)\n+    created_cts = ContentType.objects.using(using).bulk_create(cts)\n+    \n+    # Refresh the content types from the database to get their IDs\n+    # and avoid subsequent database reads that don't respect the database parameter\n+    if created_cts:\n+        fresh_cts = ContentType.objects.using(using).filter(\n+            app_label=app_label,\n+            model__in=[ct.model for ct in created_cts]\n+        )\n+        content_types.update({ct.model: ct for ct in fresh_cts})\n+    \n     if verbosity >= 2:\n-        for ct in cts:\n+        for ct in created_cts:\n             print(\"Adding content type '%s | %s'\" % (ct.app_label, ct.model))\ndiff --git a/django/contrib/contenttypes/models.py b/django/contrib/contenttypes/models.py\nindex 759a53ce67..39a80f5ef7 100644\n--- a/django/contrib/contenttypes/models.py\n+++ b/django/contrib/contenttypes/models.py\n@@ -120,11 +120,17 @@ class ContentTypeManager(models.Manager):\n             self._add_to_cache(self.db, ct)\n         return ct\n \n-    def clear_cache(self):\n+    def clear_cache(self, using=None):\n         \"\"\"\n         Clear out the content-type cache.\n         \"\"\"\n-        self._cache.clear()\n+        if using is not None:\n+            # Clear cache only for the specified database\n+            if using in self._cache:\n+                del self._cache[using]\n+        else:\n+            # Clear cache for all databases (original behavior)\n+            self._cache.clear()\n \n     def _add_to_cache(self, using, ct):\n         \"\"\"Insert a ContentType into the cache.\"\"\"\n"}