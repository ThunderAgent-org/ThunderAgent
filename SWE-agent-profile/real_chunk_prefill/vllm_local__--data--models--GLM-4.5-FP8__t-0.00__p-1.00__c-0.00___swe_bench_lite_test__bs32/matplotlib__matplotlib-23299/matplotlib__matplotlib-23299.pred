{"model_name_or_path": "vllm_local__--data--models--GLM-4.5-FP8__t-0.00__p-1.00__c-0.00___swe_bench_lite_test__bs32", "instance_id": "matplotlib__matplotlib-23299", "model_patch": "diff --git a/lib/matplotlib/__init__.py b/lib/matplotlib/__init__.py\nindex c268a56724..44d7679101 100644\n--- a/lib/matplotlib/__init__.py\n+++ b/lib/matplotlib/__init__.py\n@@ -1167,6 +1167,46 @@ if os.environ.get('MPLBACKEND'):\n     rcParams['backend'] = os.environ.get('MPLBACKEND')\n \n \n+def _resolve_auto_backend():\n+    \"\"\"\n+    Resolve the auto-backend sentinel to an actual backend name.\n+    \n+    This function determines which backend would be selected if the backend\n+    is set to auto, without actually switching to it.\n+    \n+    Returns\n+    -------\n+    str\n+        The name of the backend that would be used.\n+    \"\"\"\n+    current_framework = cbook._get_running_interactive_framework()\n+    mapping = {'qt': 'qtagg',\n+               'gtk3': 'gtk3agg',\n+               'gtk4': 'gtk4agg',\n+               'wx': 'wxagg',\n+               'tk': 'tkagg',\n+               'macosx': 'macosx',\n+               'headless': 'agg'}\n+\n+    best_guess = mapping.get(current_framework, None)\n+    if best_guess is not None:\n+        candidates = [best_guess]\n+    else:\n+        candidates = []\n+    candidates += [\n+        \"macosx\", \"qtagg\", \"gtk4agg\", \"gtk3agg\", \"tkagg\", \"wxagg\"]\n+\n+    # Try to find a working backend without actually switching\n+    for candidate in candidates:\n+        try:\n+            importlib.import_module(cbook._backend_module_name(candidate))\n+            return candidate\n+        except ImportError:\n+            continue\n+    # If no interactive backend works, fall back to agg\n+    return \"agg\"\n+\n+\n def get_backend():\n     \"\"\"\n     Return the name of the current backend.\n@@ -1175,7 +1215,13 @@ def get_backend():\n     --------\n     matplotlib.use\n     \"\"\"\n-    return rcParams['backend']\n+    # Directly access the backend value to avoid triggering auto-resolution\n+    # which has side effects like closing all figures\n+    backend = dict.__getitem__(rcParams, 'backend')\n+    if backend is rcsetup._auto_backend_sentinel:\n+        # If backend is auto, resolve it without switching to avoid side effects\n+        return _resolve_auto_backend()\n+    return backend\n \n \n def interactive(b):\n"}