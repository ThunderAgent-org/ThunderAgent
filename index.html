<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ThunderAgent - Fast, Simple, and Program-Aware Agentic Inference</title>
  <meta name="description"
    content="ThunderAgent is a fast, simple, and program-aware agentic inference system achieving 1.5-3.6x throughput improvements." />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@300;400;500;600;700&family=Share+Tech+Mono&family=Inter:wght@300;400;500;600&family=Roboto+Mono:wght@300;400;500&display=swap"
    rel="stylesheet" />
  <!-- KaTeX for math rendering -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body, {delimiters:[{left:'$$',right:'$$',display:true},{left:'$',right:'$',display:false}]});"></script>
  <script>
    tailwind.config = {
      darkMode: 'class', // Enable class-based dark mode
      theme: {
        extend: {
          colors: {
            cyber: {
              dark: 'var(--color-bg-base)',
              deeper: 'var(--color-bg-deeper)',
              panel: 'var(--color-bg-panel)',
              border: 'var(--color-border)',
              yellow: 'var(--color-primary)',
              gold: 'var(--color-primary)',
              amber: 'var(--color-primary)',
              steel: 'var(--color-text-muted)',
              chrome: '#C8C8D8',
              silver: 'var(--color-accent-blue)',
              red: '#FF003C',
            }
          },
          fontFamily: {
            heading: ['var(--font-heading)', 'sans-serif'],
            body: ['var(--font-body)', 'sans-serif'],
            mono: ['var(--font-mono)', 'monospace'],
          }
        }
      }
    }
  </script>
  <style>
    :root {
      /* === DARK THEME (DEFAULT) === */
      --color-bg-base: #1a1a2e;
      --color-bg-deeper: #12121f;
      --color-bg-panel: #1e1e35;
      --color-border: #2a2a45;

      --color-primary: #E2C044;
      /* Gold */
      --color-accent-blue: #C0C8D0;
      /* Silver */

      --color-text-main: #e0e0e8;
      --color-text-muted: #a0a0b8;

      --grid-color: rgba(252, 238, 9, 0.05);
      --scanline-color: rgba(252, 238, 9, 0.02);

      /* === FONTS (default: CLEAN — Inter & Roboto Mono) === */
      --font-body: 'Inter', sans-serif;
      --font-heading: 'Inter', sans-serif;
      --font-mono: 'Roboto Mono', monospace;

      /* === STATUS COLORS (DARK) === */
      --color-status-green: #86efac;
      /* green-300 */
      --color-status-red: #fca5a5;
      /* red-300 */
      --color-status-yellow: #fde047;
      /* yellow-300 */
      --color-status-blue: #60a5fa;
      /* blue-400 */
    }

    [data-theme="light"] {
      /* === LIGHT THEME === */
      --color-bg-base: #f0f2f5;
      /* Very Light Grey */
      --color-bg-deeper: #e2e8f0;
      /* Slightly Darker Grey */
      --color-bg-panel: #ffffff;
      /* Pure White Mode */
      --color-border: #cbd5e1;
      /* Light Border */

      --color-primary: #eab308;
      /* Even Brighter Yellow-500 */
      --color-accent-blue: #475569;
      /* Slate Blue */

      --color-text-main: #1e293b;
      /* Dark Slate */
      --color-text-muted: #64748b;
      /* Muted Slate */

      --grid-color: rgba(0, 0, 0, 0.05);
      /* Black grid */
      --scanline-color: rgba(0, 0, 0, 0.01);

      /* === STATUS COLORS (LIGHT) === */
      --color-status-green: #15803d;
      /* green-700 */
      --color-status-red: #b91c1c;
      /* red-700 */
      --color-status-yellow: #b45309;
      /* amber-700 */
      --color-status-blue: #1d4ed8;
      /* blue-700 */
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
      /* Smooth transition */
    }

    body {
      background-color: var(--color-bg-base);
      color: var(--color-text-main);
      font-family: var(--font-body);
      overflow-x: hidden;
    }

    /* === GLOW UTILITIES === */
    .glow-yellow {
      text-shadow: none;
    }

    .glow-gold {
      text-shadow: none;
    }

    .glow-amber {
      text-shadow: none;
    }

    .glow-silver {
      text-shadow: 0 0 7px #C0C8D0, 0 0 20px #C0C8D0aa, 0 0 42px #C0C8D055;
    }

    .box-glow-silver {
      box-shadow: 0 0 20px #C0C8D022, 0 0 50px #C0C8D011, inset 0 0 30px #C0C8D008;
    }

    .box-glow-yellow {
      box-shadow: none;
    }

    .box-glow-gold {
      box-shadow: none;
    }

    .box-glow-amber {
      box-shadow: none;
    }

    /* === SCANLINE OVERLAY === */
    .scanlines::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: repeating-linear-gradient(0deg,
          transparent,
          transparent 2px,
          var(--scanline-color) 2px,
          var(--scanline-color) 4px);
      pointer-events: none;
      z-index: 9999;
    }

    /* === GRID BACKGROUND === */
    .cyber-grid {
      background-image:
        linear-gradient(var(--grid-color) 1px, transparent 1px),
        linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
      background-size: 60px 60px;
    }

    /* === ANIMATED NEON BORDER === */
    .neon-border {
      position: relative;
    }

    .neon-border::before {
      content: '';
      position: absolute;
      inset: 0;
      border: 1px solid var(--color-primary);
      opacity: 0.15;
      pointer-events: none;
    }

    /* === PULSE ANIMATION === */
    @keyframes pulse-glow {

      0%,
      100% {
        opacity: 0.6;
      }

      50% {
        opacity: 1;
      }
    }

    .animate-pulse-glow {
      animation: pulse-glow 3s ease-in-out infinite;
    }

    /* === FLOAT ANIMATION === */
    @keyframes float {

      0%,
      100% {
        transform: translateY(0px);
      }

      50% {
        transform: translateY(-10px);
      }
    }

    .animate-float {
      animation: float 4s ease-in-out infinite;
    }

    /* === THUNDER LIGHTNING EFFECT === */
    @keyframes thunder-flash {

      0%,
      100% {
        opacity: 1;
        text-shadow: 0 0 10px var(--color-primary), 0 0 30px var(--color-primary), 0 0 60px var(--color-primary), 0 0 100px rgba(252, 238, 9, 0.4);
        color: var(--color-primary);
      }

      4% {
        opacity: 0.3;
        text-shadow: none;
        color: #F5D300;
      }

      5% {
        opacity: 1;
        text-shadow: 0 0 20px var(--color-primary), 0 0 50px var(--color-primary), 0 0 90px var(--color-primary);
        color: #FFFDE0;
      }

      6% {
        opacity: 0.8;
        text-shadow: 0 0 5px var(--color-primary);
        color: #F5D300;
      }

      7% {
        opacity: 1;
        text-shadow: 0 0 10px var(--color-primary), 0 0 30px var(--color-primary), 0 0 60px var(--color-primary), 0 0 100px rgba(252, 238, 9, 0.4);
        color: var(--color-primary);
      }

      38% {
        opacity: 1;
        text-shadow: 0 0 10px var(--color-primary), 0 0 30px var(--color-primary), 0 0 60px var(--color-primary), 0 0 100px rgba(252, 238, 9, 0.4);
        color: var(--color-primary);
      }

      40% {
        opacity: 0.5;
        text-shadow: 0 0 3px #F5D300;
        color: #F5D300;
      }

      41% {
        opacity: 1;
        text-shadow: 0 0 25px #FCEE09, 0 0 60px #FFFDE0, 0 0 100px #FCEE09;
        color: #FFFDE0;
      }

      42% {
        opacity: 0.2;
        text-shadow: none;
        color: #F5D300;
      }

      43% {
        opacity: 1;
        text-shadow: 0 0 10px #FCEE09, 0 0 30px #FCEE09, 0 0 60px #FCEE09, 0 0 100px #FCEE0966;
        color: #FCEE09;
      }
    }

    .thunder-electric {
      animation: thunder-flash 5s infinite;
      position: relative;
    }

    .thunder-electric::after {
      content: '';
      position: absolute;
      inset: -8px -12px;
      background: radial-gradient(ellipse, rgba(252, 238, 9, 0.15) 0%, transparent 70%);
      pointer-events: none;
      z-index: -1;
    }

    /* === SVG LIGHTNING BOLT BACKGROUND DECORATION === */
    @keyframes lightning-strike {

      0%,
      89%,
      100% {
        opacity: 0;
      }

      90% {
        opacity: 0.6;
      }

      92% {
        opacity: 0;
      }

      94% {
        opacity: 0.4;
      }

      95% {
        opacity: 0;
      }
    }

    .lightning-bolt {
      animation: lightning-strike 6s infinite;
    }

    .lightning-bolt-2 {
      animation: lightning-strike 8s 3s infinite;
    }

    /* === METALLIC AGENT TEXT === */
    .agent-metallic {
      background: linear-gradient(180deg, #e8e8ec 0%, #a0a0b0 25%, #d0d0d8 45%, #888898 65%, #b0b0c0 85%, #9090a0 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      filter: drop-shadow(0 0 8px rgba(160, 160, 176, 0.4)) drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
    }

    /* === GLITCH OVERLAY (SUBTLE) === */
    @keyframes glitch-1 {

      0%,
      100% {
        clip-path: inset(0 0 95% 0);
        transform: translate(2px, -2px);
      }

      20% {
        clip-path: inset(30% 0 50% 0);
        transform: translate(-2px, 2px);
      }

      40% {
        clip-path: inset(60% 0 20% 0);
        transform: translate(2px, 0);
      }

      60% {
        clip-path: inset(10% 0 70% 0);
        transform: translate(-1px, 1px);
      }

      80% {
        clip-path: inset(80% 0 5% 0);
        transform: translate(1px, -1px);
      }
    }

    .glitch-text {
      position: relative;
    }

    .glitch-text::before,
    .glitch-text::after {
      content: attr(data-text);
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    .glitch-text::before {
      color: #E2C044;
      animation: glitch-1 4s infinite linear alternate-reverse;
      opacity: 0.3;
    }

    .glitch-text::after {
      color: #E2C044;
      animation: glitch-1 3s infinite linear alternate;
      opacity: 0.2;
    }

    /* === SMOOTH SCROLL === */
    html {
      scroll-behavior: smooth;
    }

    /* === NAV LINK HOVER === */
    .nav-link {
      position: relative;
      transition: color 0.3s;
    }

    .nav-link::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 0;
      width: 0;
      height: 1px;
      background: #E2C044;
      box-shadow: none;
      transition: width 0.3s;
    }

    .nav-link:hover::after {
      width: 100%;
    }

    .nav-link:hover {
      color: #E2C044;
    }

    /* === FEATURE CARD HOVER === */
    .feature-card {
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .feature-card:hover {
      transform: translateY(-4px);
    }

    /* === DECORATIVE LINES === */
    .h-line-yellow {
      height: 1px;
      background: linear-gradient(90deg, transparent, #E2C044, transparent);
    }

    .h-line-gold {
      height: 1px;
      background: linear-gradient(90deg, transparent, #E2C044, transparent);
    }

    .h-line-amber {
      height: 1px;
      background: linear-gradient(90deg, transparent, #E2C044, transparent);
    }

    /* === BLOG SECTION STYLES === */
    .blog-content h3 {
      font-family: 'Orbitron', sans-serif;
      font-weight: 700;
      letter-spacing: 0.05em;
    }

    .blog-content p {
      line-height: 1.8;
    }

    .challenge-card {
      border-left: 3px solid #E2C044;
      transition: transform 0.2s, border-color 0.3s;
    }

    .challenge-card:hover {
      transform: translateX(4px);
      border-color: #E2C044;
    }

    .solution-card {
      border-left: 3px solid #A0A0B8;
      transition: transform 0.2s, border-color 0.3s;
    }

    .solution-card:hover {
      transform: translateX(4px);
      border-color: #E2C044;
    }

    /* === STAT NUMBER COUNTER-LIKE STYLE === */
    .stat-number {
      font-variant-numeric: tabular-nums;
    }

    /* === INLINE MATH SYMBOLS === */
    .math-sym {
      font-family: 'Times New Roman', Georgia, 'CMU Serif', serif;
      font-style: italic;
      letter-spacing: 0.02em;
    }

    /* === RIGHT SIDEBAR TOC === */
    .toc-sidebar {
      position: fixed;
      top: 50%;
      right: 20px;
      transform: translateY(-50%);
      z-index: 100;
      max-height: 70vh;
      overflow-y: auto;
      scrollbar-width: none;
    }

    .toc-sidebar::-webkit-scrollbar {
      display: none;
    }

    .toc-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 14px;
      font-family: 'Share Tech Mono', monospace;
      font-size: 12px;
      color: #9090b0;
      text-decoration: none;
      transition: all 0.3s ease;
      border-right: 3px solid transparent;
      white-space: nowrap;
      cursor: pointer;
    }

    .toc-item:hover {
      color: var(--color-primary);
      border-right-color: var(--color-primary);
      opacity: 0.8;
    }

    .toc-item.active {
      color: var(--color-primary);
      border-right-color: var(--color-primary);
      border-right-width: 3px;
    }

    .toc-item .toc-dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: #606080;
      flex-shrink: 0;
      transition: all 0.3s ease;
    }

    .toc-item:hover .toc-dot {
      background: var(--color-primary);
      box-shadow: 0 0 4px var(--color-primary);
    }

    .toc-item.active .toc-dot {
      background: var(--color-primary);
      box-shadow: 0 0 8px var(--color-primary);
      width: 8px;
      height: 8px;
    }

    .toc-sub {
      padding-left: 28px;
      font-size: 11px;
    }

    .toc-sub .toc-dot {
      width: 6px;
      height: 6px;
    }

    @media (max-width: 1280px) {
      .toc-sidebar {
        display: none;
      }
    }
  </style>
</head>

<body class="scanlines cyber-grid">

  <!-- ==================== NAVIGATION ==================== -->
  <nav class="fixed top-0 left-0 right-0 z-50 border-b border-cyber-border"
    style="background: var(--color-bg-base); backdrop-filter: blur(12px);">
    <div class="max-w-6xl mx-auto flex items-center justify-between px-6 py-4">
      <a href="#" class="flex items-center gap-3 group">
        <img
          src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/thunderagent-RpTQBiJ9rQntjx2mxaQBtFY6yRnEIO.png"
          alt="ThunderAgent Logo" class="w-10 h-10 object-contain" />
        <span class="font-heading text-lg tracking-widest text-cyber-yellow glow-yellow">THUNDERAGENT</span>
      </a>
      <div class="hidden md:flex items-center gap-6 font-body text-xl tracking-wider uppercase">
        <a href="https://github.com/HaoKang-Timmy/ThunderAgent" target="_blank" rel="noopener noreferrer"
          class="nav-link text-cyber-yellow font-semibold flex items-center gap-1.5" style="text-shadow: none;">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z" />
          </svg>
          Code
        </a>
        <a href="https://deepwiki.com/HaoKang-Timmy/ThunderAgent" target="_blank" rel="noopener noreferrer"
          class="nav-link text-cyber-gold font-semibold flex items-center gap-1.5" style="text-shadow: none;">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" />
          </svg>
          Wiki
        </a>
        <a href="https://arxiv.org/pdf/2602.13692"
          target="_blank" class="nav-link text-cyber-amber font-semibold flex items-center gap-1.5"
          style="text-shadow: none;">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
          </svg>
          Paper
        </a>
        <a href="https://github.com/HaoKang-Timmy/ThunderAgent" target="_blank" rel="noopener noreferrer"
          class="flex items-center gap-1.5 px-4 py-1.5 rounded-full border border-cyber-yellow/60 bg-cyber-yellow/10 hover:bg-cyber-yellow/25 text-cyber-yellow font-semibold transition-all duration-300 text-sm tracking-wider"
          style="text-shadow: none;">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
            <path
              d="M12 .587l3.668 7.568L24 9.306l-6 5.862 1.416 8.245L12 19.446l-7.416 3.967L6 15.168 0 9.306l8.332-1.151z" />
          </svg>
          Star on GitHub
        </a>

        <!-- Theme Toggle Button -->
        <button id="theme-toggle" aria-label="Toggle Dark Mode"
          class="p-2 ml-2 rounded-full hover:bg-white/10 transition-colors duration-200">
          <!-- Sun Icon (for Dark Mode) -->
          <svg id="sun-icon" class="w-6 h-6 text-cyber-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z">
            </path>
          </svg>
          <!-- Moon Icon (for Light Mode, hidden by default) -->
          <svg id="moon-icon" class="w-6 h-6 text-cyber-yellow hidden" fill="none" stroke="currentColor"
            viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
          </svg>
        </button>

        <!-- Font Selection Dropdown -->
        <div class="relative ml-2 group py-2">
          <button id="font-btn" aria-label="Select Font"
            class="p-2 rounded-full hover:bg-white/10 transition-colors duration-200 text-cyber-yellow flex items-center font-mono text-sm border border-cyber-yellow/30">
            <span class="mr-1">Aa</span>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>

          <!-- Invisible bridge to prevent hover loss -->
          <div class="absolute right-0 top-full w-full h-2 bg-transparent"></div>

          <div
            class="absolute right-0 top-[calc(100%+0.5rem)] mt-0 w-48 bg-[var(--color-bg-panel)] border border-[var(--color-border)] rounded-lg shadow-xl overflow-hidden hidden group-hover:block z-50">
            <button onclick="changeFont('cyber')"
              class="w-full text-left px-4 py-3 hover:bg-[var(--color-bg-base)] text-[var(--color-text-main)] transition-colors font-body text-sm border-b border-[var(--color-border)]">
              <span class="font-bold block mb-0.5" style="font-family: 'Orbitron', sans-serif">CYBER</span>
              <span class="text-xs opacity-70" style="font-family: 'Rajdhani', sans-serif">Orbitron & Rajdhani</span>
            </button>
            <button onclick="changeFont('clean')"
              class="w-full text-left px-4 py-3 hover:bg-[var(--color-bg-base)] text-[var(--color-text-main)] transition-colors font-sans text-sm border-b border-[var(--color-border)]">
              <span class="font-bold block mb-0.5" style="font-family: 'Inter', sans-serif">CLEAN</span>
              <span class="text-xs opacity-70" style="font-family: 'Inter', sans-serif">Inter & Roboto</span>
            </button>
            <button onclick="changeFont('mono')"
              class="w-full text-left px-4 py-3 hover:bg-[var(--color-bg-base)] text-[var(--color-text-main)] transition-colors font-mono text-sm">
              <span class="font-bold block mb-0.5" style="font-family: 'Roboto Mono', monospace">MONO</span>
              <span class="text-xs opacity-70" style="font-family: 'Roboto Mono', monospace">Terminal Style</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- ==================== HERO SECTION ==================== -->
  <section id="hero" class="relative min-h-screen flex flex-col items-center justify-center px-6 pt-24 pb-16">
    <!-- Background lightning decorations -->
    <div class="absolute inset-0 overflow-hidden pointer-events-none">
      <div class="absolute top-1/4 left-1/3 w-96 h-96 rounded-full opacity-[0.07]"
        style="background: radial-gradient(circle, #E2C044 0%, transparent 70%);"></div>
      <div class="absolute bottom-1/3 right-1/4 w-80 h-80 rounded-full opacity-[0.05]"
        style="background: radial-gradient(circle, #E2C044 0%, transparent 70%);"></div>
      <!-- Lightning SVG decorations -->
      <svg class="absolute top-20 left-[10%] w-16 h-48 lightning-bolt" viewBox="0 0 40 120" fill="none">
        <path d="M20 0 L8 55 L18 50 L5 120 L25 60 L15 65 Z" fill="#E2C044" opacity="0.4" />
      </svg>
      <svg class="absolute top-32 right-[15%] w-12 h-36 lightning-bolt-2" viewBox="0 0 40 120" fill="none">
        <path d="M20 0 L8 55 L18 50 L5 120 L25 60 L15 65 Z" fill="#E2C044" opacity="0.3" />
      </svg>
    </div>

    <div class="relative z-10 max-w-5xl mx-auto text-center">

      <!-- Logo + Title row -->
      <div class="flex items-center justify-center gap-6 md:gap-8 mb-6">
        <img
          src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/thunderagent-RpTQBiJ9rQntjx2mxaQBtFY6yRnEIO.png"
          alt="ThunderAgent Logo"
          class="w-24 h-24 md:w-32 md:h-32 lg:w-40 lg:h-40 object-contain animate-float drop-shadow-[0_0_25px_rgba(252,238,9,0.3)]" />
        <h1 class="font-heading text-4xl md:text-6xl lg:text-7xl font-bold tracking-wider leading-tight">
          <span class="glitch-text thunder-electric" data-text="THUNDER">THUNDER</span><br class="md:hidden" /><span
            class="agent-metallic">AGENT</span>
        </h1>
      </div>

      <!-- Subtitle -->
      <p class="text-xl md:text-2xl text-[var(--color-text-main)] tracking-wide mb-4 leading-loose tracking-wide max-w-3xl mx-auto max-w-3xl mx-auto"
        style="font-family: var(--font-body);">
        A <span class="text-cyber-yellow font-semibold">Fast</span>,
        <span class="text-cyber-gold font-semibold">Simple</span>, and
        <span class="text-cyber-silver font-semibold">Robust</span>
        Program-Aware Agentic Inference System
      </p>


      <!-- Stats bar -->
      <div class="flex flex-wrap justify-center gap-6 md:gap-10 mt-4 mb-12">
        <div
          class="flex flex-col items-center justify-center gap-1 w-72 px-6 py-4 border border-cyber-border bg-cyber-panel box-glow-yellow text-center">
          <span
            class="font-heading text-2xl md:text-3xl font-bold text-cyber-yellow glow-yellow stat-number">1.5-3.9×</span>
          <span class="font-heading text-sm text-[var(--color-text-main)] uppercase tracking-wider font-bold">Inference
            Throughput</span>
        </div>
        <div
          class="flex flex-col items-center justify-center gap-1 w-72 px-6 py-4 border border-cyber-border bg-cyber-panel box-glow-gold text-center">
          <span class="font-heading text-2xl md:text-3xl font-bold text-cyber-gold glow-gold stat-number">2</span>
          <span class="font-heading text-sm text-[var(--color-text-main)] uppercase tracking-wider font-bold">Lines of
            Code to Integrate</span>
        </div>
        <div
          class="flex flex-col items-center justify-center gap-1 w-72 px-6 py-4 border border-cyber-border bg-cyber-panel box-glow-amber text-center">
          <span class="font-heading text-2xl md:text-3xl font-bold stat-number"
            style="color: #C0C8D0; text-shadow: 0 0 8px rgba(192,200,208,0.5);">4.2×</span>
          <span class="font-heading text-sm text-[var(--color-text-main)] uppercase tracking-wider font-bold">Disk
            Memory Savings</span>
        </div>
      </div>
      <div class="inline-block bg-[var(--color-bg-panel)] border border-[var(--color-primary)]/40 rounded-lg px-6 md:px-8 py-4 mb-8 shadow-[0_0_15px_rgba(226,192,68,0.15)] max-w-4xl mx-auto">
        <p class="font-body text-lg md:text-xl text-[var(--color-text-main)] tracking-wide leading-relaxed">
          ThunderAgent is the <span class="text-cyber-yellow font-bold glow-yellow">first principled approach</span> to use program abstraction to schedule all resources (GPU KV caches, CPU, and remote tools) for distributed agentic inference and rollout.
        </p>
      </div>
      <!-- Divider -->
      <div class="h-line-yellow w-full max-w-3xl mx-auto mb-10 opacity-40"></div>

      <!-- Fast / Simple / Robust Tabs -->
      <div class="text-center mb-8">
        <span class="font-mono text-2xl text-cyber-yellow tracking-widest uppercase">Section 1: Fast, Simple, and
          Robust</span>
      </div>
      <div class="w-full max-w-5xl mx-auto">
        <!-- Tab buttons -->
        <div class="flex border-b border-cyber-border">
          <button onclick="switchTab('fast')" id="tab-fast"
            class="hero-tab active flex-1 py-4 px-6 font-heading text-lg md:text-xl tracking-wider font-bold transition-all duration-300 border-b-2 text-cyber-yellow border-cyber-yellow glow-yellow">
            <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor" stroke-width="1.5"
              viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
            </svg>
            FAST
          </button>
          <button onclick="switchTab('simple')" id="tab-simple"
            class="hero-tab flex-1 py-4 px-6 font-heading text-lg md:text-xl tracking-wider font-bold transition-all duration-300 border-b-2 text-[var(--color-text-muted)] border-transparent hover:text-cyber-gold">
            <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor" stroke-width="1.5"
              viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5" />
            </svg>
            SIMPLE
          </button>
          <button onclick="switchTab('robust')" id="tab-robust"
            class="hero-tab flex-1 py-4 px-6 font-heading text-lg md:text-xl tracking-wider font-bold transition-all duration-300 border-b-2 text-[var(--color-text-muted)] border-transparent hover:text-cyber-silver">
            <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor" stroke-width="1.5"
              viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" />
            </svg>
            ROBUST
          </button>
        </div>

        <!-- Tab content panels -->
        <div class="relative mt-0">
          <!-- FAST content -->
          <div id="panel-fast"
            class="tab-panel bg-cyber-panel border border-t-0 border-cyber-border p-8 md:p-10 text-left"
            style="border-top:none;">
            <div class="flex items-center justify-center gap-3 mb-4">
              <span class="font-heading text-3xl font-bold text-cyber-yellow glow-yellow">1.5-3.6×</span>
              <span class="font-heading text-xl font-bold text-[var(--color-text-main)] tracking-wide">Serving
                Throughput
                Improvement</span>
            </div>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              We evaluated multiple agentic workflows on a single 8×H100 node, ranging from mini-SWEAgent and OpenHands
              — which have lightweight and predictable tool calls — to ToolOrchestra, which involves long and
              unpredictable remote API tool calls. Results show that ThunderAgent improves vLLM throughput across
              agentic serving scenarios by <span class="text-cyber-yellow">1.5–3.6×</span>.
            </p>
            <div class="mt-4 text-center">
              <img src="public/max_throughput_bar.png?v=2" alt="High Concurrency Agentic Serving Throughput Speedup"
                class="max-w-full rounded" loading="lazy" />
            </div>

            <div class="flex items-center justify-center gap-3 mt-10 mb-4">
              <span class="font-heading text-3xl font-bold text-cyber-yellow glow-yellow">1.8-3.9×</span>
              <span class="font-heading text-xl font-bold text-[var(--color-text-main)] tracking-wide">RL Rollout
                Throughput
                Improvement</span>
            </div>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              We evaluated mini-SWEAgent and OpenHands on 2 8×H100 nodes. Results show that ThunderAgent improves vLLM
              throughput across agentic RL rollout scenarios by <span class="text-cyber-yellow">1.8–3.9×</span>.
            </p>
            <div class="mt-4 text-center">
              <img src="public/rl_rollout_bar.png?v=2" alt="High Concurrency Agentic RL Rollout Throughput Speedup"
                class="max-w-full rounded" loading="lazy" />
            </div>
          </div>

          <!-- SIMPLE content -->
          <div id="panel-simple"
            class="tab-panel bg-cyber-panel border border-t-0 border-cyber-border p-8 md:p-10 text-left hidden"
            style="border-top:none;">
            <div class="flex items-center justify-center gap-3 mb-4">
              <span class="font-heading text-3xl font-bold text-cyber-gold glow-gold">2 Lines</span>
              <span class="font-heading text-xl font-bold text-[var(--color-text-main)] tracking-wide">of Code to
                Integrate</span>
            </div>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              ThunderAgent provides a fully <span class="text-cyber-gold font-semibold">OpenAI-compatible API</span>.
              Just add a <span class="font-mono text-cyber-gold">program_id</span> to your existing API calls. It wraps
              existing LLM engines and tool orchestrators, decoupling scheduling from execution backends.
            </p>
            <div class="bg-cyber-dark border border-cyber-border p-5 font-mono text-sm overflow-x-auto">
              <div class="text-[var(--color-text-muted)]"># Just add program_id to your existing calls</div>
              <div class="mt-1"><span class="text-[var(--color-text-muted)]">extra_body</span> = {<span
                  class="text-cyber-gold">"program_id"</span>: <span class="text-cyber-amber">"unique_id"</span>}</div>
              <div class="mt-2"><span
                  class="text-[var(--color-text-muted)]">openai.client.chat.completions.create(</span></div>
              <div class="pl-4 text-[var(--color-text-muted)]">model=<span class="text-cyber-amber">"your-model"</span>,
              </div>
              <div class="pl-4 text-[var(--color-text-muted)]">messages=messages,</div>
              <div class="pl-4 text-[var(--color-text-muted)]">extra_body=extra_body <span class="text-cyber-gold"> # ←
                  that's it!</span>
              </div>
              <div class="text-[var(--color-text-muted)]">)</div>
            </div>
          </div>

          <!-- ROBUST content -->
          <div id="panel-robust"
            class="tab-panel bg-cyber-panel border border-t-0 border-cyber-border p-8 md:p-10 text-left hidden"
            style="border-top:none;">
            <!-- Point 1: Robust to High-concurrency -->
            <div class="flex items-center justify-center gap-3 mb-4">
              <span class="font-heading text-3xl font-bold"
                style="color: #C0C8D0; text-shadow: 0 0 8px rgba(192,200,208,0.5);">Robust to High-Concurrency
                Workloads</span>
            </div>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              ThunderAgent maintains maximum achievable throughput even as the number of parallel workflows scales
              beyond GPU memory limits.
            </p>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              Baseline systems suffer severe throughput collapse once the workload exceeds
              memory capacity, while ThunderAgent automatically adapts to the maximum available capacity with no need of
              manual tuning.
            </p>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              This makes it reliable for real-world deployments where workload patterns are
              unpredictable.
            </p>
            <div class="mt-4 text-center">
              <img src="public/big_6panel.png?v=2" alt="Throughput across different concurrency levels"
                class="max-w-full rounded" loading="lazy" />
            </div>

            <!-- Point 2: Dynamic Resource Reclaim -->
            <div class="flex items-center justify-center gap-3 mt-10 mb-4">
              <span class="font-heading text-3xl font-bold"
                style="color: #C0C8D0; text-shadow: 0 0 8px rgba(192,200,208,0.5);">4.2×</span>
              <span class="font-heading text-xl font-bold text-[var(--color-text-main)] tracking-wide">Disk Memory
                Savings via Dynamic
                Resource Reclaim</span>
            </div>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              ThunderAgent's lifecycle-aware garbage collector dynamically reclaims tool resources, such as Docker
              containers and temporary files, from completed workflows, preventing unused resources from accumulating
              and occupying disk space during long-running rollouts.
            </p>
          </div>
        </div>
      </div>

      <script>
        function switchTab(tab) {
          // Color mapping
          const colors = {
            fast: { text: 'text-cyber-yellow', border: 'border-cyber-yellow', glow: 'glow-yellow' },
            simple: { text: 'text-cyber-gold', border: 'border-cyber-gold', glow: 'glow-gold' },
            robust: { text: 'text-cyber-silver', border: 'border-cyber-silver', glow: 'glow-silver' }
          };

          // Reset all tabs
          document.querySelectorAll('.hero-tab').forEach(btn => {
            btn.className = btn.className.replace(/text-cyber-\w+/g, 'text-[var(--color-text-muted)]')
              .replace(/border-cyber-\w+/g, 'border-transparent')
              .replace(/glow-\w+/g, '');
          });

          // Activate selected tab
          const activeBtn = document.getElementById('tab-' + tab);
          const c = colors[tab];
          activeBtn.classList.remove('text-[var(--color-text-muted)]', 'border-transparent');
          activeBtn.classList.add(c.text, c.border, c.glow);

          // Toggle panels
          document.querySelectorAll('.tab-panel').forEach(p => p.classList.add('hidden'));
          document.getElementById('panel-' + tab).classList.remove('hidden');
        }
      </script>
    </div>
  </section>

  <!-- ==================== OVERVIEW SECTION (TABBED) ==================== -->
  <section id="abstract" class="relative px-6 py-20">
    <div class="max-w-4xl mx-auto">
      <div class="text-center mb-12">
        <span class="font-mono text-2xl text-cyber-yellow tracking-widest uppercase">Section 2: Architecture Overview
          and user manual</span>
        <div class="h-line-yellow w-40 mx-auto mt-6 opacity-50"></div>
      </div>

      <div class="w-full max-w-5xl mx-auto">
        <!-- Tab buttons -->
        <div class="flex border-b border-cyber-border">
          <button onclick="switchOverviewTab('architecture')" id="ov-tab-architecture"
            class="ov-tab active flex-1 py-4 px-6 font-heading text-lg md:text-xl tracking-wider font-bold transition-all duration-300 border-b-2 text-cyber-yellow border-cyber-yellow">
            <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor" stroke-width="1.5"
              viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M6.75 21v-3.375c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21M3 3h12m-.75 4.5H21m-3.75 0h.008v.008h-.008V7.5z" />
            </svg>
            ARCHITECTURE
          </button>
          <button onclick="switchOverviewTab('howto')" id="ov-tab-howto"
            class="ov-tab flex-1 py-4 px-6 font-heading text-lg md:text-xl tracking-wider font-bold transition-all duration-300 border-b-2 text-[var(--color-text-muted)] border-transparent hover:text-cyber-gold">
            <svg class="w-5 h-5 inline-block mr-2 -mt-0.5" fill="none" stroke="currentColor" stroke-width="1.5"
              viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round"
                d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5" />
            </svg>
            HOW TO USE
          </button>
        </div>

        <!-- Tab content panels -->
        <div class="relative mt-0">
          <!-- ARCHITECTURE content -->
          <div id="ov-panel-architecture"
            class="ov-panel bg-cyber-panel border border-t-0 border-cyber-border p-8 md:p-10 text-left"
            style="border-top:none;">
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              ThunderAgent sits between agent clients and the infrastructure layer as an <span
                class="text-cyber-yellow font-semibold">agentic workflow scheduler</span>. It improves inference
              throughput of vLLM/SGLang across multiple GPU nodes through program-aware scheduling, and provides a
              unified tool management interface for resources like Docker containers and remote APIs.
            </p>

            <div class="mt-4 text-center">
              <img src="public/arch.png" alt="ThunderAgent Architecture" class="max-w-full rounded" loading="lazy" />
            </div>
          </div>

          <!-- HOW TO USE content -->
          <div id="ov-panel-howto"
            class="ov-panel bg-cyber-panel border border-t-0 border-cyber-border p-8 md:p-10 text-left hidden"
            style="border-top:none;">
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              Using ThunderAgent requires an LLM serving engine. Here we give an example of serving an agent with <span
                class="text-cyber-gold font-semibold">vLLM</span> + <span
                class="text-cyber-gold font-semibold">Qwen3-32B</span>.
            </p>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              In this example:
            <ul class="list-disc list-inside text-[var(--color-text-main)] ml-4 mb-4">
              <li><span class="text-cyber-gold font-semibold">vLLM Server (Port 8000)</span>: Accepts inference
                requests.</li>
              <li><span class="text-cyber-gold font-semibold">ThunderAgent Router (Port 9000)</span>: Accepts
                OpenAI-formatted requests, handles agent logic, and forwards generation tasks to vLLM.</li>
            </ul>
            </p>

            <!-- Step 1: Install -->
            <p class="font-heading text-lg text-[var(--color-text-main)] font-bold mb-3 mt-2">Step 1 &mdash; Install
              vLLM &amp;
              ThunderAgent</p>
            <div class="bg-cyber-dark border border-cyber-border p-5 font-mono text-sm overflow-x-auto mb-6">
              <div><span class="text-cyber-yellow">pip install</span> vllm</div>
              <div><span class="text-cyber-yellow">git clone</span> https://github.com/HaoKang-Timmy/ThunderAgent.git
              </div>
              <div><span class="text-cyber-yellow">cd</span> ThunderAgent</div>
              <div><span class="text-cyber-yellow">pip install</span> -e .</div>
            </div>

            <!-- Step 2: Start vLLM -->
            <p class="font-heading text-lg text-[var(--color-text-main)] font-bold mb-3">Step 2 &mdash; Start vLLM </p>
            <div class="bg-cyber-dark border border-cyber-border p-5 font-mono text-sm overflow-x-auto mb-6">
              <div class="text-[var(--color-text-muted)]"># Start vLLM server on port <span
                  class="text-cyber-yellow">8000</span></div>
              <div><span class="text-cyber-yellow">vllm serve</span> Qwen/Qwen3-32B --port <span
                  class="text-cyber-yellow">8000</span></div>
            </div>

            <!-- Step 3: Start ThunderAgent -->
            <p class="font-heading text-lg text-[var(--color-text-main)] font-bold mb-3">Step 3 &mdash; Start
              ThunderAgent</p>
            <div class="bg-cyber-dark border border-cyber-border p-5 font-mono text-sm overflow-x-auto mb-6">
              <div class="text-[var(--color-text-muted)]"># Start ThunderAgent on port <span
                  class="text-cyber-yellow">9000</span>,
                and connect it to vLLM at port 8000</div>
              <div><span class="text-cyber-yellow">thunderagent</span> --backend-type vllm --backends
                http://localhost:<span class="text-cyber-yellow">8000</span> --port <span
                  class="text-cyber-yellow">9000</span></div>
            </div>

            <!-- Step 4: Send request -->
            <p class="font-heading text-lg text-[var(--color-text-main)] font-bold mb-3">Step 4 &mdash; Send requests to
              ThunderAgent
              Router</p>
            <div class="bg-cyber-dark border border-cyber-border p-5 font-mono text-sm overflow-x-auto">
              <div><span class="text-[var(--color-text-muted)]"># connect client to ThunderAgent router (port
                  9000)</span></div>
              <div><span class="text-[var(--color-text-muted)]"># ThunderAgent would forward the requests to vLLM
                  backend (port
                  8000)</span></div>
              <div class="mt-1"><span class="text-cyber-yellow">from</span> openai <span
                  class="text-cyber-yellow">import</span> OpenAI</div>
              <div class="mt-2">client = OpenAI(base_url=<span
                  class="text-cyber-gold">"http://localhost:9000/v1"</span>, api_key=<span
                  class="text-cyber-gold">"dummy"</span>)</div>
              <div class="mt-2">response = client.chat.completions.create(</div>
              <div class="pl-4">model=<span class="text-cyber-gold">"Qwen/Qwen3-32B"</span>,</div>
              <div class="pl-4">messages=[{<span class="text-cyber-gold">"role"</span>: <span
                  class="text-cyber-gold">"user"</span>, <span class="text-cyber-gold">"content"</span>: <span
                  class="text-cyber-gold">"Hello!"</span>}],</div>
              <div class="pl-4">extra_body={<span class="text-cyber-gold">"program_id"</span>: <span
                  class="text-cyber-gold">"my_agent_001"</span>}</div>
              <div>)</div>
              <div class="mt-2"><span class="text-cyber-yellow">print</span>(response.choices[0].message.content)</div>
            </div>
          </div>
        </div>
      </div>

      <script>
        function switchOverviewTab(tab) {
          const colors = {
            architecture: { text: 'text-cyber-yellow', border: 'border-cyber-yellow' },
            howto: { text: 'text-cyber-gold', border: 'border-cyber-gold' }
          };

          // Define all possible active colors to remove
          const possibleActiveClasses = [
            'text-cyber-yellow', 'border-cyber-yellow',
            'text-cyber-gold', 'border-cyber-gold'
          ];

          document.querySelectorAll('.ov-tab').forEach(btn => {
            // Remove any possible active classes
            btn.classList.remove(...possibleActiveClasses);

            // Add inactive classes
            if (!btn.classList.contains('text-[var(--color-text-muted)]')) {
              btn.classList.add('text-[var(--color-text-muted)]');
            }
            if (!btn.classList.contains('border-transparent')) {
              btn.classList.add('border-transparent');
            }
          });

          const activeBtn = document.getElementById('ov-tab-' + tab);
          const c = colors[tab];
          activeBtn.classList.remove('text-[var(--color-text-muted)]', 'border-transparent');
          activeBtn.classList.add(c.text, c.border);

          document.querySelectorAll('.ov-panel').forEach(p => p.classList.add('hidden'));
          document.getElementById('ov-panel-' + tab).classList.remove('hidden');
        }
      </script>
    </div>
  </section>

  <!-- ==================== CHALLENGES SECTION (TABBED) ==================== -->
  <section id="challenges" class="relative px-6 py-20">
    <div class="max-w-6xl mx-auto">
      <div class="text-center mb-12">
        <span class="font-mono text-2xl text-cyber-yellow tracking-widest uppercase">Section 3: Agentic Inference
          Challenges</span>
        <div class="h-line-yellow w-40 mx-auto mt-6 opacity-50"></div>
      </div>

      <div class="w-full max-w-5xl mx-auto">
        <!-- Tab buttons -->
        <div class="flex border-b border-cyber-border">
          <button onclick="switchChallengeTab('kvcache')" id="ch-tab-kvcache"
            class="ch-tab flex-1 py-4 px-4 font-heading text-base md:text-lg tracking-wider font-bold transition-all duration-300 border-b-2 text-[var(--color-status-red)] border-[var(--color-status-red)]">
            KV Cache Thrashing
          </button>
          <button onclick="switchChallengeTab('imbalance')" id="ch-tab-imbalance"
            class="ch-tab flex-1 py-4 px-4 font-heading text-base md:text-lg tracking-wider font-bold transition-all duration-300 border-b-2 text-[var(--color-text-muted)] border-transparent hover:text-[var(--color-status-red)]">
            Memory Imbalance
          </button>
          <button onclick="switchChallengeTab('unrecycled')" id="ch-tab-unrecycled"
            class="ch-tab flex-1 py-4 px-4 font-heading text-base md:text-lg tracking-wider font-bold transition-all duration-300 border-b-2 text-[var(--color-text-muted)] border-transparent hover:text-[var(--color-status-red)]">
            Unrecycled Resources
          </button>
        </div>

        <!-- Tab content panels -->
        <div class="relative mt-0">
          <!-- KV Cache Thrashing -->
          <div id="ch-panel-kvcache"
            class="ch-panel bg-cyber-panel border border-t-0 border-cyber-border p-8 md:p-10 text-left"
            style="border-top:none;">
            <div class="mb-6 text-center">
              <img src="public/KV_thrashing.png" alt="KV Cache Thrashing Illustration" class="max-w-full rounded"
                loading="lazy" />
            </div>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              Agentic workflows consist of <span class="text-[var(--color-status-red)] font-semibold">reasoning</span>
              phases (which
              consume GPU resources) and <span class="text-[var(--color-status-red)] font-semibold">acting</span> phases
              (i.e., tool
              calling, which do not consume GPU). During the acting phase, request-aware serving engines (e.g., vLLM,
              SGLang) treat the KV cache of acting workflows as evictable idle memory.
            </p>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto">
              However, under high-concurrency
              serving scenarios, nearly all GPU memory is occupied by workflow KV caches (<span
                class="text-[var(--color-status-red)] font-semibold">Step 1</span>). Reasoning
              workflows then preempt the KV cache originally belonging to acting workflows (<span
                class="text-[var(--color-status-red)] font-semibold">Step 2</span>). When those acting
              workflows later re-enter the reasoning phase, they in turn evict KV caches of other workflows (<span
                class="text-[var(--color-status-red)] font-semibold">Steps 3 &amp; 4</span>).
            </p>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mt-6">
              This cascading eviction forces a large number of workflows to recompute the entire trajectory
              prefill from scratch, dramatically increasing the <span
                class="text-[var(--color-status-red)] font-semibold">end-to-end
                latency</span> of each request.
            </p>
            <div class="mt-6 text-center">
              <img src="public/cache_hit_latency.png?v=2" alt="Cache Hit Rate & Latency" class="rounded"
                style="width:60%; height:auto; display:inline-block;" loading="lazy" />
            </div>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mt-6">
              We evaluated serving mini-SWE-Agent with GLM4.6 on a single H100 node: as the number of parallel LLM agent
              <span class="text-[var(--color-status-red)] font-semibold">workflows increases</span>, the <span
                class="text-[var(--color-status-red)] font-semibold">KV cache hit rate drops</span> significantly, and
              the average <span class="text-[var(--color-status-red)] font-semibold">end-to-end latency per request
                rises</span> sharply.
            </p>
          </div>

          <!-- Cross-Node Memory Imbalance -->
          <div id="ch-panel-imbalance"
            class="ch-panel bg-cyber-panel border border-t-0 border-cyber-border p-8 md:p-10 text-left hidden"
            style="border-top:none;">
            <div class="mb-6 text-center">
              <img src="public/Routing.png" alt="Cross-Node Memory Imbalance Illustration" class="max-w-full rounded"
                loading="lazy" />
            </div>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              Unlike request-level serving, multi-node agentic serving cannot simply focus on <span
                class="text-[var(--color-status-red)] font-semibold">load balancing</span>. Since requests within the
              same workflow share
              substantial KV cache prefixes, routing them to the same GPU node yields high KV cache hit rates(e.g., vLLM
              KV Router).
            </p>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
              However, as shown in the figure above, KV-aware routing can <span
                class="text-[var(--color-status-red)] font-semibold">exacerbate memory imbalance</span> across nodes
              when memory pressure
              is uneven. Although SGLang Gateway introduces an algorithm that switches to a load-balancing router under
              high memory imbalance, it lacks the adaptability required for multi-node and complex agentic workloads,
              often demanding <span class="text-[var(--color-status-red)] font-semibold">manual coefficient
                tuning</span>.
            </p>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto">
              In short,
              existing routers fail to dynamically balance the tradeoff between <span
                class="text-[var(--color-status-red)] font-semibold">KV cache locality</span> and <span
                class="text-[var(--color-status-red)] font-semibold">load balancing</span>, leading to suboptimal
              throughput in
              multi-GPU-node serving.
            </p>
            <div class="mt-6 text-center">
              <img src="public/mem_diff.png?v=2" alt="Memory imbalance observed when using the vLLM KV Router"
                class="rounded" style="width:60%; height:auto; display:inline-block;" loading="lazy" />
            </div>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mt-6">
              We evaluated GLM-4.6 + mini-SWE-Agent on 2 H100 nodes with the vLLM KV-aware router: <span
                class="text-[var(--color-status-red)] font-semibold">memory imbalance</span> emerges across nodes,
              reaching up to <span class="text-[var(--color-status-red)] font-semibold">51%</span>.
            </p>
          </div>

          <!-- Unrecycled Tool Resources -->
          <div id="ch-panel-unrecycled"
            class="ch-panel bg-cyber-panel border border-t-0 border-cyber-border p-8 md:p-10 text-left hidden"
            style="border-top:none;">
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto">
              Agentic workflows spawn tool environments (Docker containers, sandboxes, API sessions) that persist long
              after the workflow completes. Without lifecycle-aware reclamation, these zombie resources consume disk and
              memory, leading to <span class="text-[var(--color-status-red)] font-semibold">4× unnecessary storage
                overhead</span>.
            </p>
            <div class="mt-6 text-center">
              <img src="public/disk_usage.png?v=2" alt="Disk usage growth caused by unrecycled tool resources"
                class="rounded" style="width:60%; height:auto; display:inline-block;" loading="lazy" />
            </div>
            <p
              class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mt-6">
              If tool resources are not reclaimed in time, disk pressure keeps accumulating until nodes hit <span
                class="text-[var(--color-status-red)] font-semibold">storage bottlenecks</span>.
            </p>
          </div>
        </div>
      </div>

      <script>
        function switchChallengeTab(tab) {
          // Reset all tabs
          document.querySelectorAll('.ch-tab').forEach(btn => {
            // Remove active classes
            btn.classList.remove('text-[var(--color-status-red)]', 'border-[var(--color-status-red)]');
            // Add inactive classes (if not already present)
            if (!btn.classList.contains('text-[var(--color-text-muted)]')) {
              btn.classList.add('text-[var(--color-text-muted)]');
            }
            if (!btn.classList.contains('border-transparent')) {
              btn.classList.add('border-transparent');
            }
          });

          // Activate selected tab
          const activeBtn = document.getElementById('ch-tab-' + tab);
          // Remove inactive classes
          activeBtn.classList.remove('text-[var(--color-text-muted)]', 'border-transparent');
          // Add active classes
          activeBtn.classList.add('text-[var(--color-status-red)]', 'border-[var(--color-status-red)]');

          // Show selected panel, hide others
          document.querySelectorAll('.ch-panel').forEach(p => p.classList.add('hidden'));
          document.getElementById('ch-panel-' + tab).classList.remove('hidden');
        }
      </script>
      }
      </script>
    </div>
  </section>

  <section id="section-4" class="relative px-6 py-20 overflow-visible">
    <div class="max-w-7xl mx-auto relative z-10">

      <div class="text-center mb-20">
        <span class="font-mono text-2xl text-cyber-yellow tracking-widest uppercase">Section 4: Our Method and Design
          Philosophy</span>
        <div class="h-line-yellow w-64 mx-auto mt-6 opacity-50"></div>
        <p
          class="font-body text-xl md:text-2xl text-[var(--color-text-main)] tracking-wide mt-8 leading-loose tracking-wide max-w-3xl text-justify mx-auto max-w-4xl mx-auto">
          ThunderAgent wraps each agentic workflow into a Stateful <span
            class="text-cyber-yellow font-bold">Program</span>: the central control unit that drives scheduling,
          routing, and resource management across the entire system.
        </p>
      </div>

      <div id="section-4-1" class="mb-32">
        <div class="flex items-center gap-4 mb-12">
          <div class="h-8 w-1 bg-cyber-yellow"></div>
          <h2 class="font-heading text-3xl text-[var(--color-text-main)] tracking-wider">Section 4.1: Program
            Abstraction</h2>
        </div>

        <div class="w-full max-w-6xl mx-auto">
          <!-- Tab buttons -->
          <div class="flex border-b border-cyber-border mb-8">
            <button onclick="switchProgTab('definition')" id="prog-tab-definition"
              class="prog-tab flex-1 py-4 px-4 font-heading text-lg md:text-xl tracking-wider font-bold transition-all duration-300 border-b-2 text-cyber-yellow border-cyber-yellow">
              What is a Program
            </button>
            <button onclick="switchProgTab('contrast')" id="prog-tab-contrast"
              class="prog-tab flex-1 py-4 px-4 font-heading text-lg md:text-xl tracking-wider font-bold transition-all duration-300 border-b-2 text-[var(--color-text-muted)] border-transparent hover:text-cyber-yellow">
              Program-Aware vs Request-Aware
            </button>
          </div>

          <!-- Panels -->
          <div class="relative min-h-[500px]">

            <!-- 1. DEFINITION Panel: Six fields grid -->
            <div id="prog-panel-definition" class="prog-panel animate-fadeIn">
              <div
                class="bg-cyber-panel border border-cyber-border p-8 md:p-12 rounded-lg shadow-lg relative overflow-hidden">
                <div
                  class="absolute top-0 right-0 w-64 h-64 bg-cyber-yellow/5 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none">
                </div>

                <h3 class="font-heading text-2xl text-[var(--color-text-main)] mb-10 text-center max-w-3xl mx-auto">
                  Six fields that turn stateless requests into schedulable programs</h3>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-5xl mx-auto">

                  <!-- ID: Program Identity -->
                  <div
                    class="bg-[var(--color-bg-deeper)] border border-cyber-border rounded-lg p-6 hover:border-cyber-yellow/50 transition-colors group">
                    <div class="flex items-center gap-3 mb-4">
                      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-[#f59e0b]/10 border border-[#f59e0b]/30"><span style="font-family: 'Times New Roman', Georgia, serif; font-style: italic;" class="text-xl text-[#f59e0b] font-bold">ID</span></span>
                      <span class="font-heading text-lg text-[var(--color-text-main)] tracking-wide">Program
                        Identity</span>
                    </div>
                    <p class="font-body text-base text-[var(--color-text-muted)] leading-relaxed mb-3">
                      Links all multi-turn requests from the same agent task into one unit.
                    </p>
                    <div
                      class="bg-[var(--color-bg-base)] rounded px-3 py-2 text-sm font-mono text-[var(--color-text-muted)]">
                      <span class="text-[var(--color-status-green)]">&rarr;</span> The glue that makes program-level
                      scheduling possible
                    </div>
                  </div>

                  <!-- c: Context Length -->
                  <div
                    class="bg-[var(--color-bg-deeper)] border border-cyber-border rounded-lg p-6 hover:border-cyber-yellow/50 transition-colors group">
                    <div class="flex items-center gap-3 mb-4">
                      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-[#4ade80]/10 border border-[#4ade80]/30"><span style="font-family: 'Times New Roman', Georgia, serif; font-style: italic;" class="text-2xl text-[#4ade80]">c</span></span>
                      <span class="font-heading text-lg text-[var(--color-text-main)] tracking-wide">Context
                        Length</span>
                    </div>
                    <p class="font-body text-base text-[var(--color-text-muted)] leading-relaxed mb-3">
                      Tracks the KV cache footprint of each program in real time.
                    </p>
                    <div
                      class="bg-[var(--color-bg-base)] rounded px-3 py-2 text-sm font-mono text-[var(--color-text-muted)]">
                      <span class="text-[var(--color-status-green)]">&rarr;</span> Evict lowest-cost programs under
                      memory pressure
                    </div>
                  </div>

                  <!-- T: Tool Environments -->
                  <div
                    class="bg-[var(--color-bg-deeper)] border border-cyber-border rounded-lg p-6 hover:border-cyber-yellow/50 transition-colors group">
                    <div class="flex items-center gap-3 mb-4">
                      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-fuchsia-400/10 border border-fuchsia-400/30"><span style="font-family: 'Times New Roman', Georgia, serif; font-style: italic;" class="text-2xl text-fuchsia-400">T</span></span>
                      <span class="font-heading text-lg text-[var(--color-text-main)] tracking-wide">Tool
                        Environments</span>
                    </div>
                    <p class="font-body text-base text-[var(--color-text-muted)] leading-relaxed mb-3">
                      Set of tool resources (containers, sandboxes) bound to this program.
                    </p>
                    <div
                      class="bg-[var(--color-bg-base)] rounded px-3 py-2 text-sm font-mono text-[var(--color-text-muted)]">
                      <span class="text-[var(--color-status-green)]">&rarr;</span> Auto-reclaim resources when program
                      terminates
                    </div>
                  </div>

                  <!-- L: Backend Location -->
                  <div
                    class="bg-[var(--color-bg-deeper)] border border-cyber-border rounded-lg p-6 hover:border-cyber-yellow/50 transition-colors group">
                    <div class="flex items-center gap-3 mb-4">
                      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-[#fbbf24]/15 border border-[#fbbf24]/40"><span style="font-family: 'Times New Roman', Georgia, serif; font-style: italic;" class="text-2xl text-[#fbbf24]">L</span></span>
                      <span class="font-heading text-lg text-[var(--color-text-main)] tracking-wide">Backend
                        Location</span>
                    </div>
                    <p class="font-body text-base text-[var(--color-text-muted)] leading-relaxed mb-3">
                      Which GPU node currently hosts this program's KV cache.
                    </p>
                    <div
                      class="bg-[var(--color-bg-base)] rounded px-3 py-2 text-sm font-mono text-[var(--color-text-muted)]">
                      <span class="text-[var(--color-status-green)]">&rarr;</span> Route requests to same node for
                      context locality
                    </div>
                  </div>

                  <!-- tau: Execution Phase -->
                  <div
                    class="bg-[var(--color-bg-deeper)] border border-cyber-border rounded-lg p-6 hover:border-cyber-yellow/50 transition-colors group">
                    <div class="flex items-center gap-3 mb-4">
                      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-[#4fc1ff]/10 border border-[#4fc1ff]/30"><span style="font-family: 'Times New Roman', Georgia, serif; font-style: italic;" class="text-2xl text-[#4fc1ff]">&tau;</span></span>
                      <span class="font-heading text-lg text-[var(--color-text-main)] tracking-wide">Execution
                        Phase</span>
                    </div>
                    <p class="font-body text-base text-[var(--color-text-muted)] leading-relaxed mb-3">
                      Distinguishes <span class="text-cyber-yellow font-semibold">Reasoning</span> (GPU-bound) from
                      <span class="text-[#4fc1ff] font-semibold">Acting</span> (tool-bound, GPU idle).
                    </p>
                    <div
                      class="bg-[var(--color-bg-base)] rounded px-3 py-2 text-sm font-mono text-[var(--color-text-muted)]">
                      <span class="text-[var(--color-status-green)]">&rarr;</span> Scheduler knows <em>when</em> to
                      reclaim GPU from idle programs
                    </div>
                  </div>

                  <!-- s: Scheduling State -->
                  <div
                    class="bg-[var(--color-bg-deeper)] border border-cyber-border rounded-lg p-6 hover:border-cyber-yellow/50 transition-colors group">
                    <div class="flex items-center gap-3 mb-4">
                      <span class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-[#fb923c]/10 border border-[#fb923c]/30"><span style="font-family: 'Times New Roman', Georgia, serif; font-style: italic;" class="text-2xl text-[#fb923c]">s</span></span>
                      <span class="font-heading text-lg text-[var(--color-text-main)] tracking-wide">Scheduling
                        State</span>
                    </div>
                    <p class="font-body text-base text-[var(--color-text-muted)] leading-relaxed mb-3">
                      Active, Paused, or Terminated — the global lifecycle of the program.
                    </p>
                    <div
                      class="bg-[var(--color-bg-base)] rounded px-3 py-2 text-sm font-mono text-[var(--color-text-muted)]">
                      <span class="text-[var(--color-status-green)]">&rarr;</span> Pause &amp; resume programs across
                      nodes for load balancing
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <!-- 3. CONTRAST Panel: Program-Aware vs Request-Aware -->
            <div id="prog-panel-contrast" class="prog-panel hidden animate-fadeIn">
              <div
                class="bg-[var(--color-bg-base)] border border-cyber-border p-8 md:p-12 rounded-lg shadow-inner flex flex-col items-center">

                <h3 class="font-heading text-3xl text-[var(--color-text-main)] mb-5 text-center max-w-3xl mx-auto">
                  From Request-Aware to Program-Aware</h3>
                <p
                  class="font-body text-xl text-[var(--color-text-main)] opacity-90 leading-relaxed text-center max-w-2xl mx-auto mb-10">
                  With program abstraction, the serving system sees <span class="text-cyber-yellow font-bold">stateful
                    programs</span> instead of isolated requests, unlocking scheduling decisions that were
                  previously impossible.
                </p>

                <div class="flex flex-col gap-10 w-full max-w-3xl">
                  <!-- Old Way -->
                  <div class="group">
                    <div
                      class="flex justify-between items-end text-xl font-mono text-[var(--color-text-main)] opacity-70 mb-3 uppercase tracking-widest border-b border-dashed border-[var(--color-text-main)]/40 pb-2">
                      <span>Request-Aware System</span>
                      <span class="text-[var(--color-status-red)] group-hover:text-red-400 transition-colors">Stateless
                        Requests</span>
                    </div>
                    <div class="flex gap-4 mb-3">
                      <div
                        class="h-24 flex-1 border-2 border-[var(--color-text-main)]/40 border-dashed rounded-lg flex items-center justify-center text-[var(--color-text-main)] opacity-50 text-xl font-mono">
                        Req1</div>
                      <div
                        class="h-24 flex-1 border-2 border-[var(--color-text-main)]/40 border-dashed rounded-lg flex items-center justify-center text-[var(--color-text-main)] opacity-50 text-xl font-mono">
                        Req2</div>
                      <div
                        class="h-24 flex-1 border-2 border-[var(--color-text-main)]/40 border-dashed rounded-lg flex items-center justify-center text-[var(--color-text-main)] opacity-50 text-xl font-mono">
                        Req3</div>
                    </div>
                    <p class="text-xl text-[var(--color-text-main)] opacity-60 font-body italic text-center">No knowledge of which
                      requests belong together, when GPU is idle, or how to balance across nodes</p>
                  </div>

                  <!-- Arrow down -->
                  <div class="flex justify-center text-[var(--color-text-muted)]">
                    <svg class="w-12 h-12 animate-bounce opacity-70" fill="none" stroke="currentColor"
                      viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
                    </svg>
                  </div>

                  <!-- New Way -->
                  <div class="group">
                    <div
                      class="flex justify-between items-end text-xl font-mono text-cyber-yellow mb-3 uppercase tracking-widest border-b border-cyber-yellow pb-2">
                      <span>Program-Aware System</span>
                      <span class="text-cyber-yellow font-bold group-hover:text-yellow-300 transition-colors">Stateful
                        Programs</span>
                    </div>

                    <!-- Program A -->
                    <div class="flex items-center gap-4 mb-4">
                      <span class="text-2xl font-mono text-cyber-yellow/80 w-14 text-right">P1</span>
                      <div
                        class="h-20 w-full border border-cyber-yellow rounded-lg flex items-center relative overflow-hidden bg-cyber-yellow/5 shadow-[0_0_15px_rgba(252,238,9,0.1)]">
                        <div
                          class="absolute inset-y-0 left-0 bg-cyber-yellow/20 w-1/3 border-r border-cyber-yellow flex items-center justify-center text-xl font-bold text-cyber-yellow tracking-wide">
                          Reasoning</div>
                        <div
                          class="absolute inset-y-0 left-1/3 bg-[var(--color-status-blue)]/20 w-1/4 border-r border-cyber-yellow flex items-center justify-center text-xl font-bold text-[var(--color-status-blue)] tracking-wide">
                          Acting</div>
                        <div
                          class="absolute inset-y-0 left-[58.33%] bg-cyber-yellow/20 w-1/3 border-r border-cyber-yellow flex items-center justify-center text-xl font-bold text-cyber-yellow tracking-wide">
                          Reasoning</div>
                      </div>
                    </div>

                    <!-- Program B -->
                    <div class="flex items-center gap-4 mb-4">
                      <span class="text-2xl font-mono text-cyber-yellow/80 w-14 text-right">P2</span>
                      <div
                        class="h-20 w-full border border-cyber-yellow rounded-lg flex items-center relative overflow-hidden bg-cyber-yellow/5 shadow-[0_0_15px_rgba(252,238,9,0.1)]">
                        <div
                          class="absolute inset-y-0 left-0 bg-[var(--color-status-blue)]/20 w-1/4 border-r border-cyber-yellow flex items-center justify-center text-xl font-bold text-[var(--color-status-blue)] tracking-wide">
                          Acting</div>
                        <div
                          class="absolute inset-y-0 left-1/4 bg-cyber-yellow/20 w-1/2 border-r border-cyber-yellow flex items-center justify-center text-xl font-bold text-cyber-yellow tracking-wide">
                          Reasoning</div>
                        <div
                          class="absolute inset-y-0 left-3/4 bg-[var(--color-status-blue)]/20 w-1/4 flex items-center justify-center text-xl font-bold text-[var(--color-status-blue)] tracking-wide">
                          Acting</div>
                      </div>
                    </div>

                    <p class="text-xl text-[var(--color-text-main)] opacity-80 font-body text-center mt-4 leading-relaxed">
                      <span class="math-sym not-italic text-[#4fc1ff]">&tau;</span> reveals GPU idle windows &bull; <span class="math-sym not-italic text-[#4ade80]">c</span> guides eviction<br>
                      <span class="math-sym not-italic text-[#fbbf24]">L</span> enables locality-aware routing &bull; <span class="math-sym not-italic text-[#fb923c]">s</span> enables cross-node load balancing
                    </p>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>

      <!-- ===== Section 4.2: Program-Aware Scheduler and Resource Management (Tabbed) ===== -->
      <div id="section-4-2" class="mb-32">
        <div class="flex items-center gap-4 mb-12">
          <div class="h-8 w-1 bg-cyber-gold"></div>
          <h2 class="font-heading text-3xl text-[var(--color-text-main)] tracking-wider">Section 4.2: Program-Aware
            Scheduler and Resource Management</h2>
        </div>

        <div class="w-full max-w-5xl mx-auto">
          <!-- Tab buttons -->
          <div class="flex border-b border-cyber-border">
            <button onclick="switchSchedTab('overview')" id="sc-tab-overview"
              class="sc-tab flex-1 py-4 px-4 font-heading text-base md:text-lg tracking-wider font-bold transition-all duration-300 border-b-2 text-cyber-gold border-cyber-gold">
              Overview
            </button>
            <button onclick="switchSchedTab('monitor')" id="sc-tab-monitor"
              class="sc-tab flex-1 py-4 px-4 font-heading text-base md:text-lg tracking-wider font-bold transition-all duration-300 border-b-2 text-[var(--color-text-muted)] border-transparent hover:text-cyber-gold">
              Periodic Monitor
            </button>
            <button onclick="switchSchedTab('queue')" id="sc-tab-queue"
              class="sc-tab flex-1 py-4 px-4 font-heading text-base md:text-lg tracking-wider font-bold transition-all duration-300 border-b-2 text-[var(--color-text-muted)] border-transparent hover:text-cyber-gold">
              Global Waiting Queue
            </button>
            <button onclick="switchSchedTab('toolmgmt')" id="sc-tab-toolmgmt"
              class="sc-tab flex-1 py-4 px-4 font-heading text-base md:text-lg tracking-wider font-bold transition-all duration-300 border-b-2 text-[var(--color-text-muted)] border-transparent hover:text-cyber-gold">
              Tool Resource Management
            </button>
          </div>

          <!-- Tab content panels -->
          <div class="relative mt-0">

            <!-- ===== Overview Panel (formerly 4.2) ===== -->
            <div id="sc-panel-overview"
              class="sc-panel bg-cyber-panel border border-t-0 border-cyber-border p-8 md:p-10 text-left"
              style="border-top:none;">
              <p
                class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
                ThunderAgent's multi-node scheduling algorithm operates at the <span
                  class="text-[var(--color-status-red)] font-bold">program</span> granularity.
                A periodic monitor checks each GPU node at fixed intervals and pauses programs on nodes that have
                accumulated too many active programs,
                preventing <span class="text-[var(--color-status-red)] font-bold">KV cache thrashing</span>.
              </p>
              <p
                class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
                Paused programs are placed into a <span class="text-[var(--color-status-red)] font-bold">global waiting
                  queue</span> shared across all GPU nodes.
                When the monitor detects that a node is <span
                  class="text-[var(--color-status-red)] font-bold">underutilized</span>,
                queued programs are dispatched to different nodes in a load-balanced manner, achieving
                <span class="text-[var(--color-status-red)] font-bold">memory balance</span> across the cluster and
                increasing agentic inference throughput.
              </p>

              <p
                class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-10">
                Upon program completion, the scheduler updates the reference count of the associated tool resources
                (e.g., containers, images).
                If the count drops to zero, resources are <span
                  class="text-[var(--color-status-red)] font-bold">reclaimed immediately</span> by dynamically freeing
                unused resources and enabling agents to run reliably over extended periods.
              </p>

              <!-- Full-width image below -->
              <div
                class="relative p-3 bg-gradient-to-br from-cyber-gold/10 to-transparent border border-cyber-gold/30 rounded-lg">
                <img src="public/TR.png" alt="Scheduler Architecture Overview" class="w-full rounded shadow-2xl"
                  loading="lazy" />
              </div>
            </div>

            <!-- ===== Periodic Monitor Panel (formerly 4.3) ===== -->
            <div id="sc-panel-monitor"
              class="sc-panel bg-cyber-panel border border-t-0 border-cyber-border p-8 md:p-10 text-left hidden"
              style="border-top:none;">
              <p
                class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-8">
                In agentic workloads, <span class="text-[var(--color-status-red)] font-bold">KV cache thrashing</span>
                can occur even when
                no new requests or programs arrive because context lengths grow continuously during decoding, silently
                exceeds
                memory beyond of GPU node.
              </p>
              <p
                class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-8">
                To catch this, ThunderAgent employs a
                <span class="text-[var(--color-status-red)] font-bold">periodic monitor</span> that evaluates the memory
                usage of each
                GPU node at fixed intervals <span class="math-sym text-[var(--color-status-red)]">&Delta;t</span>,
                enabling preemptive detection of memory pressure before it degrades throughput.
              </p>

              <!-- Thrashing Detection Mechanism -->
              <div class="bg-[var(--color-bg-deeper)] border border-cyber-border p-8 rounded-lg mb-8">
                <h4 class="font-heading text-xl text-[var(--color-text-main)] font-bold mb-4 text-center">Detection
                  Overview</h4>
                <p
                  class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-4">
                  The monitor checks each GPU node for two conditions:
                  <span class="text-[var(--color-status-red)] font-bold">thrashing</span> (memory overloaded) and
                  <span class="text-[var(--color-status-red)] font-bold">underutilization</span> (memory underused).
                  Based on the diagnosis, it takes one of two actions:
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                  <div class="flex items-start gap-4">
                    <div
                      class="w-12 h-12 bg-amber-500/10 border border-[var(--color-status-yellow)]/40 rounded-full flex items-center justify-center shrink-0">
                      <span class="font-mono text-[var(--color-status-yellow)] text-lg font-bold">!</span>
                    </div>
                    <div>
                      <p class="text-lg text-[var(--color-text-main)] font-semibold mb-1">Thrashing Detected</p>
                      <p class="text-lg text-[var(--color-text-muted)] font-body">
                        <span class="text-[var(--color-status-yellow)] font-bold">Pause</span> programs on the
                        overloaded node — evict them from GPU and save their state to the global waiting queue.
                      </p>
                    </div>
                  </div>
                  <div class="flex items-start gap-4">
                    <div
                      class="w-12 h-12 bg-green-500/10 border border-[var(--color-status-green)] rounded-full flex items-center justify-center shrink-0">
                      <span class="font-mono text-green-400 text-lg font-bold">&check;</span>
                    </div>
                    <div>
                      <p class="text-lg text-[var(--color-text-main)] font-semibold mb-1">Underutilization Detected</p>
                      <p class="text-lg text-[var(--color-text-muted)] font-body">
                        <span class="text-[var(--color-status-green)] font-bold">Restore</span> programs from the
                        waiting queue back to the GPU node, resuming their execution.
                      </p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Time-Decay & Shortest-First -->
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="bg-[var(--color-bg-deeper)] border border-cyber-border p-8 rounded-lg">
                  <h4 class="font-heading text-xl text-[var(--color-text-main)] font-bold mb-4 text-center">Time-Decay
                    for Restoring</h4>
                  <p
                    class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-4">
                    During tool execution, GPU memory occupied by acting programs' KV caches sits idle. To balance the
                    cost
                    of caching against recomputation, ThunderAgent applies an <span
                      class="text-[var(--color-status-red)] font-bold">exponential time-decay function</span>
                    <span class="math-sym text-[var(--color-status-red)]">f(t)</span> that progressively discounts the
                    effective memory
                    weight of acting programs. This encourages the scheduler to pause and evict long-idle contexts when
                    memory pressure rises, rather than holding them indefinitely.
                  </p>
                  <div class="bg-cyber-dark border border-cyber-border p-5 rounded mt-4 text-center overflow-x-auto">
                    $$\text{C}_{\text{total}} \;<\; \sum_{p \in \mathcal{L},\, \tau=\mathbf{R}} c_p \;+\; \sum_{q \in
                      \mathcal{L},\, \tau=\mathbf{A}} c_q \times f(t_q)$$ </div>
                  </div>
                  <div class="bg-[var(--color-bg-deeper)] border border-cyber-border p-8 rounded-lg">
                    <h4 class="font-heading text-xl text-[var(--color-text-main)] font-bold mb-4 text-center">
                      Shortest-First Eviction</h4>
                    <p
                      class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-4">
                      When the scheduler needs to evict programs to free $\Delta C$ tokens of memory, ThunderAgent
                      greedily
                      selects programs with the <span class="text-[var(--color-status-red)] font-bold">shortest context
                        lengths</span>.
                      Since recomputation cost scales quadratically with token length
                      ($\text{Cost}_{\text{recompute}} \propto c_i^2$), evicting shorter contexts minimizes the total
                      recomputation overhead.
                    </p>
                    <p
                      class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto">
                      The state indicator $\mathbb{I}$ further ensures that the scheduler prioritizes pausing
                      <span class="text-[var(--color-status-red)] font-bold">Acting</span> programs (reclaiming cached
                      memory to reduce
                      $\text{Cost}_{\text{caching}}$) and prioritizes restoring
                      <span class="text-[var(--color-status-red)] font-bold">Reasoning</span> programs (maximizing
                      effective decoding
                      throughput).
                    </p>
                  </div>
                </div>
              </div>

              <!-- ===== Global Waiting Queue Panel (formerly 4.4) ===== -->
              <div id="sc-panel-queue"
                class="sc-panel bg-cyber-panel border border-t-0 border-cyber-border p-8 md:p-10 text-left hidden"
                style="border-top:none;">
                <!-- Part 1: Pause / Restore Priority -->
                <h4 class="font-heading text-xl text-[var(--color-text-main)] font-bold mb-6 text-center">Shortest-First
                  Scheduling Priority</h4>
                <p
                  class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
                  The global waiting queue determines <em>which</em> programs to pause or restore using a scoring
                  function
                  that combines the program's <span class="text-[var(--color-status-red)] font-bold">execution
                    phase</span> (reasoning vs. acting)
                  with its <span class="text-[var(--color-status-red)] font-bold">context length</span>:
                </p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                  <!-- Pause priority -->
                  <div class="bg-[var(--color-bg-deeper)] border border-[var(--color-status-yellow)]/30 p-6 rounded-lg">
                    <div class="flex items-center gap-3 mb-3">
                      <span
                        class="px-3 py-1.5 rounded border border-[var(--color-status-yellow)]/50 bg-amber-500/10 text-[var(--color-status-yellow)] font-mono text-sm uppercase font-bold">Pause
                        Priority</span>
                    </div>
                    <div class="bg-cyber-dark border border-cyber-border p-4 rounded text-center overflow-x-auto mb-4">
                      $$S_{\text{pause}}(P) = \frac{1}{c_P} + \mathbb{I}(\tau = \mathbf{A})$$
                    </div>
                    <p
                      class="text-lg text-[var(--color-text-muted)] font-body leading-loose tracking-wide max-w-3xl text-justify mx-auto">
                      <span class="text-[var(--color-status-yellow)] font-bold">Acting</span> programs are paused first
                      (their KV cache is idle during tool execution).
                      Among them, <span class="text-[var(--color-status-yellow)] font-bold">shorter</span> contexts are
                      evicted first to minimize quadratic recomputation cost.
                    </p>
                  </div>
                  <!-- Restore priority -->
                  <div class="bg-[var(--color-bg-deeper)] border border-[var(--color-status-green)] p-6 rounded-lg">
                    <div class="flex items-center gap-3 mb-3">
                      <span
                        class="px-3 py-1.5 rounded border border-[var(--color-status-green)] bg-green-500/10 text-[var(--color-status-green)] font-mono text-sm uppercase font-bold">Restore
                        Priority</span>
                    </div>
                    <div class="bg-cyber-dark border border-cyber-border p-4 rounded text-center overflow-x-auto mb-4">
                      $$S_{\text{restore}}(P) = \frac{1}{c_P} + \mathbb{I}(\tau = \mathbf{R})$$
                    </div>
                    <p
                      class="text-lg text-[var(--color-text-muted)] font-body leading-loose tracking-wide max-w-3xl text-justify mx-auto">
                      <span class="text-[var(--color-status-green)] font-bold">Reasoning</span> programs are restored
                      first (they directly contribute to decoding throughput).
                      Shorter contexts are restored first to minimize recomputation overhead.
                    </p>
                  </div>
                </div>

                <!-- Part 2: Why load-balanced restore -->
                <h4 class="font-heading text-xl text-[var(--color-text-main)] font-bold mb-6 mt-10 text-center">Why
                  Load-Balanced Restore?</h4>
                <p
                  class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-6">
                  Existing KV-aware routers greedily pin all requests from the same workflow to the same GPU node for
                  cache locality.
                  This causes severe <span class="text-[var(--color-status-red)] font-bold">memory imbalance</span> —
                  some nodes are overloaded while others sit idle.
                </p>
                <p
                  class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-8">
                  The key insight is: once a program is paused, its KV cache has already been <span
                    class="text-[var(--color-status-red)] font-bold">evicted</span>.
                  Recomputation cost is therefore <span
                    class="text-[var(--color-status-red)] font-bold">node-agnostic</span> — there is no locality benefit
                  in sending it back to the original node.
                  This allows the global queue to dispatch restored programs to <span
                    class="text-[var(--color-status-red)] font-bold">any node with available capacity</span>
                  in a load-balanced manner, achieving cross-node memory balance without sacrificing KV cache locality
                  for active programs.
                </p>
              </div>

              <!-- ===== Tool Resource Management Panel (formerly 4.5) ===== -->
              <div id="sc-panel-toolmgmt"
                class="sc-panel bg-cyber-panel border border-t-0 border-cyber-border p-8 md:p-10 text-left hidden"
                style="border-top:none;">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
                  <!-- Hook-based GC -->
                  <div class="bg-[var(--color-bg-deeper)] border border-cyber-border p-8 rounded-lg">
                    <div class="flex items-center justify-center gap-3 mb-6">
                      <div
                        class="w-12 h-12 bg-red-500/10 border border-[var(--color-status-red)]/40 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-[var(--color-status-red)]" fill="none" stroke="currentColor"
                          stroke-width="1.5" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round"
                            d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />
                        </svg>
                      </div>
                      <h4 class="font-heading text-xl text-[var(--color-text-main)] font-bold">Hook-Based Garbage
                        Collection</h4>
                    </div>
                    <p
                      class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-4">
                      ThunderAgent implements lifecycle hooks that strictly couple tool resource persistence with the
                      program's scheduling status <span class="math-sym text-[var(--color-status-red)]">s</span>. When
                      a program is <span class="text-[var(--color-status-red)] font-bold">Terminated</span>, the
                      collector triggers an immediate teardown
                      sequence that systematically reclaiming sandboxes, Docker containers, network sockets, and compute
                      slots.
                    </p>
                    <p
                      class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto">
                      This lifecycle-aware policy maintains <span
                        class="text-[var(--color-status-red)] font-bold">near-constant disk
                        memory consumption</span> over time, preventing the unbounded resource accumulation observed in
                      systems without program-level garbage collection.
                    </p>
                  </div>

                  <!-- Async Env Preparation -->
                  <div class="bg-[var(--color-bg-deeper)] border border-cyber-border p-8 rounded-lg">
                    <div class="flex items-center justify-center gap-3 mb-6">
                      <div
                        class="w-12 h-12 bg-cyber-gold/10 border border-cyber-gold/40 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-cyber-gold" fill="none" stroke="currentColor" stroke-width="1.5"
                          viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round"
                            d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" />
                        </svg>
                      </div>
                      <h4 class="font-heading text-xl text-[var(--color-text-main)] font-bold">Asynchronous Environment
                        Preparation</h4>
                    </div>
                    <p
                      class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto mb-4">
                      Tool execution environments (e.g., Docker containers, dependency installation) are costly to
                      initialize.
                      ThunderAgent monitors the global waiting queue; when a high-priority program approaches the
                      restore
                      threshold, the system <span class="text-[var(--color-status-yellow)] font-bold">asynchronously
                        pre-builds</span>
                      its execution environment before GPU memory is allocated.
                    </p>
                    <p
                      class="font-body text-xl text-[var(--color-text-main)] leading-loose tracking-wide max-w-3xl text-justify mx-auto">
                      This technique effectively <span class="text-[var(--color-status-yellow)] font-bold">hides the
                        initialization
                        overhead</span>, significantly reducing end-to-end latency for tool-call heavy workloads like
                      coding agents and science agents.
                    </p>
                  </div>
                </div>
              </div>

            </div>
          </div>

          <script>
            function switchSchedTab(tab) {
              document.querySelectorAll('.sc-tab').forEach(btn => {
                btn.className = btn.className.replace(/text-cyber-\w+/g, 'text-[var(--color-text-muted)]')
                  .replace(/border-cyber-\w+/g, 'border-transparent');
              });
              const activeBtn = document.getElementById('sc-tab-' + tab);
              activeBtn.classList.remove('text-[var(--color-text-muted)]', 'border-transparent');
              activeBtn.classList.add('text-cyber-gold', 'border-cyber-gold');
              document.querySelectorAll('.sc-panel').forEach(p => p.classList.add('hidden'));
              document.getElementById('sc-panel-' + tab).classList.remove('hidden');
            }
          </script>
        </div>

      </div>
  </section>

  <!-- ==================== CITATION ==================== -->
  <section id="citation" class="relative py-16 md:py-24 px-6" style="background: var(--color-bg-base);">
    <div class="max-w-4xl mx-auto">
      <h2 class="font-heading text-2xl md:text-3xl text-[var(--color-text-main)] tracking-wider mb-2">Citation</h2>
      <p class="font-body text-[var(--color-text-muted)] text-lg mb-6">If you find ThunderAgent useful, please cite our work:</p>
      <div class="bg-cyber-dark border border-cyber-border rounded-lg overflow-hidden">
        <pre class="p-5 font-mono text-sm text-[var(--color-text-main)] overflow-x-auto leading-relaxed whitespace-pre"><code>@misc{kang2026thunderagentsimplefastprogramaware,
      title={ThunderAgent: A Simple, Fast and Program-Aware Agentic Inference System},
      author={Hao Kang and Ziyang Li and Xinyu Yang and Weili Xu and Yinfang Chen and Junxiong Wang and Beidi Chen and Tushar Krishna and Chenfeng Xu and Simran Arora},
      year={2026},
      eprint={2602.13692},
      archivePrefix={arXiv},
      primaryClass={cs.OS},
      url={https://arxiv.org/abs/2602.13692},
}</code></pre>
      </div>
    </div>
  </section>

  <!-- ==================== RIGHT SIDEBAR TOC ==================== -->
  <nav class="toc-sidebar" id="toc-sidebar">
    <a href="#hero" class="toc-item" data-section="hero">
      <span class="toc-dot"></span>Fast, Simple, and Robust
    </a>
    <a href="#abstract" class="toc-item" data-section="abstract">
      <span class="toc-dot"></span>Overview and Manual
    </a>
    <a href="#challenges" class="toc-item" data-section="challenges">
      <span class="toc-dot"></span>Agentic Inference Challenges
    </a>
    <a href="#section-4" class="toc-item" data-section="section-4">
      <span class="toc-dot"></span>Method and Design
    </a>
    <a href="#section-4-1" class="toc-item toc-sub" data-section="section-4-1">
      <span class="toc-dot"></span>Program Abstraction
    </a>
    <a href="#section-4-2" class="toc-item toc-sub" data-section="section-4-2">
      <span class="toc-dot"></span>Scheduler and Resource Management
    </a>
    <a href="#citation" class="toc-item" data-section="citation">
      <span class="toc-dot"></span>Citation
    </a>
  </nav>

  <script>
    (function () {
      const tocItems = document.querySelectorAll('.toc-item[data-section]');
      const sections = [];
      tocItems.forEach(item => {
        const id = item.getAttribute('data-section');
        const el = document.getElementById(id);
        if (el) sections.push({ id, el, link: item });
      });

      function updateActive() {
        // Calculate trigger point: 30% down the viewport
        const triggerPoint = window.scrollY + (window.innerHeight * 0.3);

        let current = sections[0];
        for (const s of sections) {
          // Use getBoundingClientRect to get absolute position relative to viewport, 
          // then add scrollY to get position relative to document top.
          // This fixes issues with nested sections (like section-4-1) having small offsetTop relative to parent.
          const rect = s.el.getBoundingClientRect();
          const absoluteTop = rect.top + window.scrollY;

          if (absoluteTop <= triggerPoint) {
            current = s;
          }
        }

        tocItems.forEach(item => item.classList.remove('active'));
        if (current) current.link.classList.add('active');
      }

      window.addEventListener('scroll', updateActive, { passive: true });
      updateActive();
    })();
  </script>

  <!-- ==================== FOOTER ==================== -->
  <footer class="border-t border-cyber-border px-6 py-10" style="background: var(--color-bg-panel);">
    <div class="max-w-6xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4">
      <div class="flex items-center gap-3">
        <img
          src="https://hebbkx1anhila5yf.public.blob.vercel-storage.com/thunderagent-RpTQBiJ9rQntjx2mxaQBtFY6yRnEIO.png"
          alt="ThunderAgent Logo" class="w-8 h-8 object-contain" />
        <span class="font-mono text-xs text-[var(--color-text-muted)] tracking-wider"><span
            class="text-cyber-yellow">THUNDER</span><span class="text-[var(--color-text-muted)]">AGENT</span> //
          Program-Aware Agentic Inference</span>
      </div>
      <div class="flex items-center gap-6">
        <a href="https://github.com/HaoKang-Timmy/ThunderAgent" target="_blank" rel="noopener noreferrer"
          class="font-mono text-xs text-[var(--color-text-muted)] hover:text-cyber-yellow transition-colors tracking-wider">
          GITHUB
        </a>
        <a href="https://github.com/HaoKang-Timmy/ThunderAgent/tree/main/wiki" target="_blank" rel="noopener noreferrer"
          class="font-mono text-xs text-[var(--color-text-muted)] hover:text-cyber-yellow transition-colors tracking-wider">
          WIKI
        </a>
      </div>
    </div>
  </footer>

  <script>
    // Theme Toggle Logic
    const toggleBtn = document.getElementById('theme-toggle');
    const sunIcon = document.getElementById('sun-icon');
    const moonIcon = document.getElementById('moon-icon');
    const htmlElement = document.documentElement;

    // Check Local Storage — default to 'dark'
    const savedTheme = localStorage.getItem('theme');
    const systemTheme = 'dark';

    // Apply Theme
    function applyTheme(theme) {
      if (theme === 'light') {
        htmlElement.setAttribute('data-theme', 'light');
        sunIcon.classList.add('hidden');
        moonIcon.classList.remove('hidden');
      } else {
        htmlElement.removeAttribute('data-theme');
        sunIcon.classList.remove('hidden');
        moonIcon.classList.add('hidden');
      }
    }

    // Initialize Theme — default to light
    applyTheme(savedTheme || systemTheme);

    // Font Logic
    const root = document.documentElement;
    const fonts = {
      cyber: {
        heading: "'Orbitron', sans-serif",
        body: "'Rajdhani', sans-serif",
        mono: "'Share Tech Mono', monospace"
      },
      clean: {
        heading: "'Inter', sans-serif",
        body: "'Inter', sans-serif",
        mono: "'Roboto Mono', monospace"
      },
      mono: {
        heading: "'Roboto Mono', monospace",
        body: "'Roboto Mono', monospace",
        mono: "'Roboto Mono', monospace"
      }
    };

    function changeFont(style) {
      const fontConfig = fonts[style];
      if (!fontConfig) return;

      root.style.setProperty('--font-heading', fontConfig.heading);
      root.style.setProperty('--font-body', fontConfig.body);
      root.style.setProperty('--font-mono', fontConfig.mono);

      localStorage.setItem('font-style', style);
    }

    // Initialize Font — default to 'clean' if no saved preference
    const savedFont = localStorage.getItem('font-style');
    if (savedFont && fonts[savedFont]) {
      changeFont(savedFont);
    } else {
      changeFont('clean');
    }

    // Event Listener
    toggleBtn.addEventListener('click', () => {
      const currentTheme = htmlElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';

      applyTheme(newTheme);
      localStorage.setItem('theme', newTheme);
    });

    /* === Section 4.1 Logic === */
    function switchProgTab(tabName) {
      // 1. Hide all panels
      document.querySelectorAll('.prog-panel').forEach(el => el.classList.add('hidden'));

      // 2. Show target panel
      document.getElementById(`prog-panel-${tabName}`).classList.remove('hidden');

      // 3. Update Tab Styles
      document.querySelectorAll('.prog-tab').forEach(btn => {
        // Reset to inactive
        btn.classList.remove('text-cyber-yellow', 'border-cyber-yellow');
        btn.classList.add('text-[var(--color-text-muted)]', 'border-transparent');
      });

      // Set active tab
      const activeBtn = document.getElementById(`prog-tab-${tabName}`);
      activeBtn.classList.remove('text-[var(--color-text-muted)]', 'border-transparent');
      activeBtn.classList.add('text-cyber-yellow', 'border-cyber-yellow');
    }

    // (progDetails and showProgDetail removed — code snippet panel was dropped)
  </script>
</body>

</html>